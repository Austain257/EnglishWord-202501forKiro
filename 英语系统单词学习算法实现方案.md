# è‹±è¯­ç³»ç»Ÿå•è¯å­¦ä¹ ç®—æ³•å®ç°æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºè‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿ç†è®ºï¼Œå®ç°ä»¥**30åˆ†é’Ÿæ–°è¯å­¦ä¹  + ä¸¤è½®å¼ºåˆ¶å¤ä¹ **ä¸ºæ ¸å¿ƒçš„æœ€å°è®°å¿†å¼ºåŒ–å•å…ƒï¼Œé€šè¿‡çŠ¶æ€é”æœºåˆ¶ç¡®ä¿ç”¨æˆ·ä¸¥æ ¼éµå¾ªç§‘å­¦å¤ä¹ èŠ‚å¥ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. æ–°è¯å­¦ä¹ é˜¶æ®µï¼ˆ30åˆ†é’Ÿä¸“æ³¨æ¨¡å¼ï¼‰
- 30åˆ†é’Ÿå€’è®¡æ—¶å­¦ä¹ ç»„ä»¶
- å­¦ä¹ èŒƒå›´é€‰æ‹©ä¸ç®¡ç†
- å­¦ä¹ è®°å½•è‡ªåŠ¨ä¿å­˜
- å­¦ä¹ ç»“æŸå¼ºåˆ¶æ ‡è®°æœºåˆ¶

### 2. çŠ¶æ€é”å®šä¸åŠŸèƒ½ç¦ç”¨æœºåˆ¶
- å…¨å±€åŠŸèƒ½é”å®šæ£€æŸ¥
- å¤ä¹ ä»»åŠ¡å®ŒæˆéªŒè¯
- ç”¨æˆ·å¼•å¯¼ä¸æç¤º

### 3. å¤ä¹ ä¸­å¿ƒ
- ç¬¬ä¸€è½®å¤ä¹ ï¼ˆè‹±è¯‘æ±‰å¡ç‰‡ï¼‰
- ç¬¬äºŒè½®å¤ä¹ ï¼ˆéšæœºæ¨¡å¼é€‰æ‹©ï¼‰
- å¤ä¹ å®Œæˆæ ‡è®°

### 4. æ•°æ®ç»Ÿè®¡ä¸æ¸…å•ç”Ÿæˆ
- æ¯æ—¥å­¦ä¹ æ¸…å•è‡ªåŠ¨ç”Ÿæˆ
- å­¦ä¹ æ•°æ®ç»Ÿè®¡åˆ†æ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Spring Boot 3.5.4 + JDK 17
- **æ•°æ®åº“**: MySQL 8.0
- **ORM**: MyBatis 3.0.4
- **ç«¯å£**: 8080

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Vue 3.5.25
- **è·¯ç”±**: Vue Router 4.6.4
- **çŠ¶æ€ç®¡ç†**: Pinia 3.0.4
- **UIæ ·å¼**: Tailwind CSS 3.4.19
- **HTTPå®¢æˆ·ç«¯**: Axios 1.13.2

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

#### 1. å•è¯å­¦ä¹ è®°å½•è¡¨ `word_study_record`
```sql
CREATE TABLE `word_study_record` (
  `id` bigint UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ï¼Œè‡ªå¢ã€‚å”¯ä¸€æ ‡è¯†æ¯æ¬¡å­¦ä¹ è®°å½•',
  `user_id` bigint UNSIGNED NOT NULL COMMENT 'ç”¨æˆ·idï¼Œå¤–é”®ï¼Œå…³è”ç”¨æˆ·è¡¨',
  `start_time` datetime NOT NULL COMMENT 'å¼€å§‹å­¦ä¹ æ—¶é—´',
  `start_id` int UNSIGNED NOT NULL COMMENT 'æœ¬è½®å­¦ä¹ å•è¯èŒƒå›´çš„èµ·å§‹ID',
  `end_time` datetime NOT NULL COMMENT 'å®é™…ç»“æŸæ—¶é—´',
  `end_id` int UNSIGNED NOT NULL COMMENT 'æœ¬è½®å­¦ä¹ å•è¯èŒƒå›´çš„ç»“æŸID',
  `status` tinyint UNSIGNED NOT NULL DEFAULT 1 COMMENT 'ä¼šè¯çŠ¶æ€ï¼š1-è¿›è¡Œä¸­ï¼Œ0-æ­£å¸¸ç»“æŸï¼Œ4-å¼‚å¸¸é€€å‡º',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'è®°å½•æ·»åŠ æ•°æ®çš„æ—¶é—´',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'è®°å½•çš„æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´',
  `round_1_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬ä¸€è½®å¤ä¹ ç»“æŸçš„æ—¶é—´',
  `round_2_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬äºŒè½®å¤ä¹ ç»“æŸçš„æ—¶é—´',
  `round_3_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬ä¸‰è½®å¤ä¹ ç»“æŸçš„æ—¶é—´',
  `round_4_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬å››è½®å¤ä¹ ç»“æŸçš„æ—¶é—´',
  `round_5_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬äº”è½®å¤ä¹ ç»“æŸçš„æ—¶é—´',
  `round_6_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬å…­è½®å¤ä¹ ç»“æŸçš„æ—¶é—´',
  `round_7_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬ä¸ƒè½®å¤ä¹ ç»“æŸçš„æ—¶é—´',
  `round_8_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬å…«è½®å¤ä¹ ç»“æŸçš„æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_start_time` (`start_time`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·å•è¯å­¦ä¹ è®°å½•è¡¨';
```

## ğŸ”„ å®ç°æ­¥éª¤è§„åˆ’

### é˜¶æ®µä¸€ï¼šæ•°æ®åº“å±‚å®ç°ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

#### 1.1 åˆ›å»ºæ ¸å¿ƒæ•°æ®è¡¨
- [x] å­¦ä¹ æ¸…å•è¡¨ `learning_checklist` (å·²å­˜åœ¨)
- [ ] å•è¯å­¦ä¹ è®°å½•è¡¨ `word_study_record` (éœ€åˆ›å»º)

**SQLåˆ›å»ºè„šæœ¬ï¼š**
```sql
CREATE TABLE `word_study_record` (
  `id` bigint UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ï¼Œè‡ªå¢ã€‚å”¯ä¸€æ ‡è¯†æ¯æ¬¡å­¦ä¹ è®°å½•',
  `user_id` bigint UNSIGNED NOT NULL COMMENT 'ç”¨æˆ·idï¼Œå¤–é”®ï¼Œå…³è”ç”¨æˆ·è¡¨ï¼Œæ ‡è¯†æ˜¯å“ªä¸ªç”¨æˆ·çš„å­¦ä¹ è®°å½•',
  `start_time` datetime NOT NULL COMMENT 'å¼€å§‹å­¦ä¹ æ—¶é—´ï¼ˆç”¨æˆ·ç‚¹å‡»"å¼€å§‹å­¦ä¹ "æ—¶è®°å½•çš„å¼€å§‹æ—¶é—´ï¼‰',
  `start_id` int UNSIGNED NOT NULL COMMENT 'æœ¬è½®å­¦ä¹ å•è¯èŒƒå›´çš„èµ·å§‹IDï¼ˆè®¡æ—¶å¼€å§‹æ—¶è®°å½•ï¼‰',
  `end_time` datetime NOT NULL COMMENT 'å®é™…ç»“æŸæ—¶é—´ï¼ˆç”¨æˆ·ç‚¹å‡»"ç»“æŸå­¦ä¹ "æ—¶è®°å½•çš„ç»“æŸæ—¶é—´ï¼‰',
  `end_id` int UNSIGNED NOT NULL COMMENT 'æœ¬è½®å­¦ä¹ å•è¯èŒƒå›´çš„ç»“æŸIDï¼ˆè®¡æ—¶ç»“æŸæ—¶è®°å½•ï¼‰',
  `status` tinyint UNSIGNED NOT NULL DEFAULT 1 COMMENT 'ä¼šè¯çŠ¶æ€ï¼š1-è¿›è¡Œä¸­ï¼Œ0-æ­£å¸¸ç»“æŸï¼Œ4-å¼‚å¸¸é€€å‡ºã€‚ç”¨äºå®¹é”™',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'è®°å½•æ·»åŠ æ•°æ®çš„æ—¶é—´ï¼Œæ•°æ®åº“é»˜è®¤å½“å‰æ—¶é—´',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'è®°å½•çš„æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ä¿®æ”¹æ—¶é—´',
  `round_1_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬ä¸€è½®å¤ä¹ ç»“æŸçš„æ—¶é—´ï¼ˆé»˜è®¤å€¼nullï¼Œè¡¨ç¤ºæœªå¤ä¹ ï¼‰',
  `round_2_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬äºŒè½®å¤ä¹ ç»“æŸçš„æ—¶é—´ï¼ˆé»˜è®¤å€¼nullï¼Œè¡¨ç¤ºæœªå¤ä¹ ï¼‰',
  `round_3_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬ä¸‰è½®å¤ä¹ ç»“æŸçš„æ—¶é—´ï¼ˆé»˜è®¤å€¼nullï¼Œè¡¨ç¤ºæœªå¤ä¹ ï¼‰',
  `round_4_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬å››è½®å¤ä¹ ç»“æŸçš„æ—¶é—´ï¼ˆé»˜è®¤å€¼nullï¼Œè¡¨ç¤ºæœªå¤ä¹ ï¼‰',
  `round_5_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬äº”è½®å¤ä¹ ç»“æŸçš„æ—¶é—´ï¼ˆé»˜è®¤å€¼nullï¼Œè¡¨ç¤ºæœªå¤ä¹ ï¼‰',
  `round_6_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬å…­è½®å¤ä¹ ç»“æŸçš„æ—¶é—´ï¼ˆé»˜è®¤å€¼nullï¼Œè¡¨ç¤ºæœªå¤ä¹ ï¼‰',
  `round_7_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬ä¸ƒè½®å¤ä¹ ç»“æŸçš„æ—¶é—´ï¼ˆé»˜è®¤å€¼nullï¼Œè¡¨ç¤ºæœªå¤ä¹ ï¼‰',
  `round_8_review_time` datetime DEFAULT NULL COMMENT 'ç¬¬å…«è½®å¤ä¹ ç»“æŸçš„æ—¶é—´ï¼ˆé»˜è®¤å€¼nullï¼Œè¡¨ç¤ºæœªå¤ä¹ ï¼‰',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_start_time` (`start_time`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·å•è¯å­¦ä¹ è®°å½•è¡¨';
```

#### 1.2 æ•°æ®åº“è§¦å‘å™¨å’Œå­˜å‚¨è¿‡ç¨‹
- [ ] æ¯æ—¥å­¦ä¹ æ¸…å•è‡ªåŠ¨ç”Ÿæˆå®šæ—¶ä»»åŠ¡
- [ ] å­¦ä¹ è®°å½•çŠ¶æ€æ›´æ–°è§¦å‘å™¨

**å®šæ—¶ä»»åŠ¡SQLè„šæœ¬ï¼š**
```sql
-- åˆ›å»ºæ¯æ—¥å­¦ä¹ æ¸…å•ç”Ÿæˆå­˜å‚¨è¿‡ç¨‹
DELIMITER $$
CREATE PROCEDURE GenerateDailyLearningChecklist()
BEGIN
    DECLARE done INT DEFAULT FALSE;
    DECLARE v_user_id BIGINT;
    DECLARE v_min_start_id INT;
    DECLARE v_max_end_id INT;
    DECLARE v_yesterday DATE;
    
    -- æ¸¸æ ‡å£°æ˜
    DECLARE user_cursor CURSOR FOR 
        SELECT DISTINCT user_id 
        FROM word_study_record 
        WHERE DATE(create_time) = DATE_SUB(CURDATE(), INTERVAL 1 DAY)
        AND status = 0;
    
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
    
    SET v_yesterday = DATE_SUB(CURDATE(), INTERVAL 1 DAY);
    
    OPEN user_cursor;
    
    read_loop: LOOP
        FETCH user_cursor INTO v_user_id;
        IF done THEN
            LEAVE read_loop;
        END IF;
        
        -- è·å–è¯¥ç”¨æˆ·æ˜¨å¤©çš„å­¦ä¹ èŒƒå›´
        SELECT MIN(start_id), MAX(end_id) 
        INTO v_min_start_id, v_max_end_id
        FROM word_study_record 
        WHERE user_id = v_user_id 
        AND DATE(create_time) = v_yesterday
        AND status = 0;
        
        -- æ’å…¥å­¦ä¹ æ¸…å•
        IF v_min_start_id IS NOT NULL AND v_max_end_id IS NOT NULL THEN
            INSERT INTO learning_checklist (
                user_id, 
                learning_record, 
                type, 
                selected, 
                already_reviewed, 
                create_time, 
                update_time
            ) VALUES (
                v_user_id,
                CONCAT('å­¦ä¹ æ–°å•è¯èŒƒå›´ä»', v_min_start_id, 'åˆ°', v_max_end_id),
                1,
                0,
                0,
                DATE_ADD(v_yesterday, INTERVAL 15 HOUR),
                NOW()
            );
        END IF;
        
    END LOOP;
    
    CLOSE user_cursor;
END$$
DELIMITER ;
```

### é˜¶æ®µäºŒï¼šåç«¯APIå®ç°ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

#### 2.1 å®ä½“ç±»åˆ›å»º

**WordStudyRecord.java**
```java
package com.austain.domain.po;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import java.time.LocalDateTime;

/**
 * å•è¯å­¦ä¹ è®°å½•å®ä½“ç±»
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class WordStudyRecord {
    
    /**
     * ä¸»é”®ID
     */
    private Long id;
    
    /**
     * ç”¨æˆ·ID
     */
    private Long userId;
    
    /**
     * å¼€å§‹å­¦ä¹ æ—¶é—´
     */
    private LocalDateTime startTime;
    
    /**
     * æœ¬è½®å­¦ä¹ å•è¯èŒƒå›´çš„èµ·å§‹ID
     */
    private Integer startId;
    
    /**
     * å®é™…ç»“æŸæ—¶é—´
     */
    private LocalDateTime endTime;
    
    /**
     * æœ¬è½®å­¦ä¹ å•è¯èŒƒå›´çš„ç»“æŸID
     */
    private Integer endId;
    
    /**
     * ä¼šè¯çŠ¶æ€ï¼š1-è¿›è¡Œä¸­ï¼Œ0-æ­£å¸¸ç»“æŸï¼Œ4-å¼‚å¸¸é€€å‡º
     */
    private Integer status;
    
    /**
     * è®°å½•åˆ›å»ºæ—¶é—´
     */
    private LocalDateTime createTime;
    
    /**
     * è®°å½•æ›´æ–°æ—¶é—´
     */
    private LocalDateTime updateTime;
    
    /**
     * ç¬¬ä¸€è½®å¤ä¹ ç»“æŸæ—¶é—´
     */
    private LocalDateTime round1ReviewTime;
    
    /**
     * ç¬¬äºŒè½®å¤ä¹ ç»“æŸæ—¶é—´
     */
    private LocalDateTime round2ReviewTime;
    
    /**
     * ç¬¬ä¸‰è½®å¤ä¹ ç»“æŸæ—¶é—´
     */
    private LocalDateTime round3ReviewTime;
    
    /**
     * ç¬¬å››è½®å¤ä¹ ç»“æŸæ—¶é—´
     */
    private LocalDateTime round4ReviewTime;
    
    /**
     * ç¬¬äº”è½®å¤ä¹ ç»“æŸæ—¶é—´
     */
    private LocalDateTime round5ReviewTime;
    
    /**
     * ç¬¬å…­è½®å¤ä¹ ç»“æŸæ—¶é—´
     */
    private LocalDateTime round6ReviewTime;
    
    /**
     * ç¬¬ä¸ƒè½®å¤ä¹ ç»“æŸæ—¶é—´
     */
    private LocalDateTime round7ReviewTime;
    
    /**
     * ç¬¬å…«è½®å¤ä¹ ç»“æŸæ—¶é—´
     */
    private LocalDateTime round8ReviewTime;
}
```

**è¯·æ±‚å’Œå“åº”DTOç±»**
```java
// StudySessionRequest.java
package com.austain.domain.dto;

import lombok.Data;

@Data
public class StudySessionRequest {
    private Long userId;
    private Integer startId;
    private Integer studyDuration; // å­¦ä¹ æ—¶é•¿ï¼Œå•ä½ç§’ï¼Œé»˜è®¤1800ï¼ˆ30åˆ†é’Ÿï¼‰
}

// StudyEndRequest.java
package com.austain.domain.dto;

import lombok.Data;
import java.time.LocalDateTime;

@Data
public class StudyEndRequest {
    private Integer endId;
    private LocalDateTime actualEndTime;
}

// ReviewCompleteRequest.java
package com.austain.domain.dto;

import lombok.Data;
import java.time.LocalDateTime;

@Data
public class ReviewCompleteRequest {
    private Long userId;
    private Long sessionId;
    private Integer reviewRound; // å¤ä¹ è½®æ¬¡ï¼š1-8
    private LocalDateTime completedTime;
}

// StudyLockStatusResponse.java
package com.austain.domain.dto;

import lombok.Data;
import java.util.List;

@Data
public class StudyLockStatusResponse {
    private Boolean isLocked;
    private String reason;
    private List<String> allowedActions;
    private List<String> blockedActions;
    private String message;
    private List<PendingReview> pendingReviews;
    
    @Data
    public static class PendingReview {
        private Long sessionId;
        private String range;
        private Integer pendingRound;
        private LocalDateTime createTime;
    }
}
```

#### 2.2 å•è¯å­¦ä¹ è®°å½•ç®¡ç†API

**WordStudyController.java**
```java
package com.austain.controller;

import com.austain.domain.dto.*;
import com.austain.domain.po.WordStudyRecord;
import com.austain.srevice.WordStudyService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

/**
 * å•è¯å­¦ä¹ è®°å½•æ§åˆ¶å™¨
 */
@RestController
@RequestMapping("/api/word-study")
public class WordStudyController {
    
    @Autowired
    private WordStudyService wordStudyService;
    
    /**
     * å¼€å§‹å­¦ä¹ ä¼šè¯
     */
    @PostMapping("/start")
    public Result startStudySession(@RequestBody StudySessionRequest request) {
        System.out.println("å¼€å§‹å­¦ä¹ ä¼šè¯å·²è§¦å‘");
        try {
            WordStudyRecord session = wordStudyService.startStudySession(request);
            return Result.success(session);
        } catch (Exception e) {
            return Result.error("å¼€å§‹å­¦ä¹ ä¼šè¯å¤±è´¥ï¼š" + e.getMessage());
        }
    }
    
    /**
     * ç»“æŸå­¦ä¹ ä¼šè¯
     */
    @PostMapping("/end/{sessionId}")
    public Result endStudySession(@PathVariable Long sessionId, @RequestBody StudyEndRequest request) {
        System.out.println("ç»“æŸå­¦ä¹ ä¼šè¯å·²è§¦å‘ï¼Œä¼šè¯IDï¼š" + sessionId);
        try {
            WordStudyRecord session = wordStudyService.endStudySession(sessionId, request);
            return Result.success(session);
        } catch (Exception e) {
            return Result.error("ç»“æŸå­¦ä¹ ä¼šè¯å¤±è´¥ï¼š" + e.getMessage());
        }
    }
    
    /**
     * æ£€æŸ¥ç”¨æˆ·å¤ä¹ çŠ¶æ€
     */
    @GetMapping("/review-status/{userId}")
    public Result checkReviewStatus(@PathVariable Long userId) {
        System.out.println("æ£€æŸ¥å¤ä¹ çŠ¶æ€å·²è§¦å‘ï¼Œç”¨æˆ·IDï¼š" + userId);
        try {
            StudyLockStatusResponse status = wordStudyService.checkReviewStatus(userId);
            return Result.success(status);
        } catch (Exception e) {
            return Result.error("æ£€æŸ¥å¤ä¹ çŠ¶æ€å¤±è´¥ï¼š" + e.getMessage());
        }
    }
    
    /**
     * æ ‡è®°å¤ä¹ å®Œæˆ
     */
    @PostMapping("/review/complete")
    public Result markReviewComplete(@RequestBody ReviewCompleteRequest request) {
        System.out.println("æ ‡è®°å¤ä¹ å®Œæˆå·²è§¦å‘ï¼Œè½®æ¬¡ï¼š" + request.getReviewRound());
        try {
            boolean success = wordStudyService.markReviewComplete(request);
            if (success) {
                return Result.success("ç¬¬" + request.getReviewRound() + "è½®å¤ä¹ å·²å®Œæˆ");
            } else {
                return Result.error("æ ‡è®°å¤ä¹ å®Œæˆå¤±è´¥");
            }
        } catch (Exception e) {
            return Result.error("æ ‡è®°å¤ä¹ å®Œæˆå¤±è´¥ï¼š" + e.getMessage());
        }
    }
    
    /**
     * è·å–ç”¨æˆ·ä»Šæ—¥å­¦ä¹ è®°å½•
     */
    @GetMapping("/today-records/{userId}")
    public Result getTodayRecords(@PathVariable Long userId) {
        System.out.println("è·å–ä»Šæ—¥å­¦ä¹ è®°å½•å·²è§¦å‘ï¼Œç”¨æˆ·IDï¼š" + userId);
        try {
            List<WordStudyRecord> records = wordStudyService.getTodayRecords(userId);
            return Result.success(records);
        } catch (Exception e) {
            return Result.error("è·å–ä»Šæ—¥å­¦ä¹ è®°å½•å¤±è´¥ï¼š" + e.getMessage());
        }
    }
}
```

#### 2.3 å­¦ä¹ çŠ¶æ€æ£€æŸ¥API

**StudyLockController.java**
```java
package com.austain.controller;

import com.austain.domain.dto.Result;
import com.austain.domain.dto.StudyLockStatusResponse;
import com.austain.srevice.StudyLockService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

/**
 * å­¦ä¹ é”å®šçŠ¶æ€æ§åˆ¶å™¨
 */
@RestController
@RequestMapping("/api/study-lock")
public class StudyLockController {
    
    @Autowired
    private StudyLockService studyLockService;
    
    /**
     * æ£€æŸ¥åŠŸèƒ½é”å®šçŠ¶æ€
     */
    @GetMapping("/check/{userId}")
    public Result checkLockStatus(@PathVariable Long userId) {
        System.out.println("æ£€æŸ¥åŠŸèƒ½é”å®šçŠ¶æ€å·²è§¦å‘ï¼Œç”¨æˆ·IDï¼š" + userId);
        try {
            StudyLockStatusResponse status = studyLockService.checkLockStatus(userId);
            return Result.success(status);
        } catch (Exception e) {
            return Result.error("æ£€æŸ¥é”å®šçŠ¶æ€å¤±è´¥ï¼š" + e.getMessage());
        }
    }
    
    /**
     * è·å–å¾…å®Œæˆå¤ä¹ ä»»åŠ¡
     */
    @GetMapping("/pending-reviews/{userId}")
    public Result getPendingReviews(@PathVariable Long userId) {
        System.out.println("è·å–å¾…å®Œæˆå¤ä¹ ä»»åŠ¡å·²è§¦å‘ï¼Œç”¨æˆ·IDï¼š" + userId);
        try {
            List<StudyLockStatusResponse.PendingReview> reviews = studyLockService.getPendingReviews(userId);
            return Result.success(reviews);
        } catch (Exception e) {
            return Result.error("è·å–å¾…å®Œæˆå¤ä¹ ä»»åŠ¡å¤±è´¥ï¼š" + e.getMessage());
        }
    }
}
```

#### 2.4 æœåŠ¡å±‚æ¥å£å®šä¹‰

**WordStudyService.java**
```java
package com.austain.srevice;

import com.austain.domain.dto.*;
import com.austain.domain.po.WordStudyRecord;
import java.util.List;

/**
 * å•è¯å­¦ä¹ æœåŠ¡æ¥å£
 */
public interface WordStudyService {
    
    /**
     * å¼€å§‹å­¦ä¹ ä¼šè¯
     */
    WordStudyRecord startStudySession(StudySessionRequest request);
    
    /**
     * ç»“æŸå­¦ä¹ ä¼šè¯
     */
    WordStudyRecord endStudySession(Long sessionId, StudyEndRequest request);
    
    /**
     * æ£€æŸ¥ç”¨æˆ·å¤ä¹ çŠ¶æ€
     */
    StudyLockStatusResponse checkReviewStatus(Long userId);
    
    /**
     * æ ‡è®°å¤ä¹ å®Œæˆ
     */
    boolean markReviewComplete(ReviewCompleteRequest request);
    
    /**
     * è·å–ç”¨æˆ·ä»Šæ—¥å­¦ä¹ è®°å½•
     */
    List<WordStudyRecord> getTodayRecords(Long userId);
    
    /**
     * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æœªå®Œæˆçš„å¤ä¹ ä»»åŠ¡
     */
    boolean hasUnfinishedReview(Long userId);
}
```

**StudyLockService.java**
```java
package com.austain.srevice;

import com.austain.domain.dto.StudyLockStatusResponse;
import java.util.List;

/**
 * å­¦ä¹ é”å®šæœåŠ¡æ¥å£
 */
public interface StudyLockService {
    
    /**
     * æ£€æŸ¥åŠŸèƒ½é”å®šçŠ¶æ€
     */
    StudyLockStatusResponse checkLockStatus(Long userId);
    
    /**
     * è·å–å¾…å®Œæˆå¤ä¹ ä»»åŠ¡
     */
    List<StudyLockStatusResponse.PendingReview> getPendingReviews(Long userId);
    
    /**
     * æ£€æŸ¥æ˜¯å¦å…è®¸è®¿é—®æŒ‡å®šåŠŸèƒ½
     */
    boolean isActionAllowed(Long userId, String action);
}
```

#### 2.5 Mapperæ¥å£å®šä¹‰

**WordStudyMapper.java**
```java
package com.austain.mapper;

import com.austain.domain.po.WordStudyRecord;
import org.apache.ibatis.annotations.*;
import java.time.LocalDateTime;
import java.util.List;

/**
 * å•è¯å­¦ä¹ è®°å½•Mapper
 */
@Mapper
public interface WordStudyMapper {
    
    /**
     * æ’å…¥å­¦ä¹ è®°å½•
     */
    @Insert("INSERT INTO word_study_record (user_id, start_time, start_id, end_time, end_id, status, create_time, update_time) " +
            "VALUES (#{userId}, #{startTime}, #{startId}, #{endTime}, #{endId}, #{status}, #{createTime}, #{updateTime})")
    @Options(useGeneratedKeys = true, keyProperty = "id")
    int insertStudyRecord(WordStudyRecord record);
    
    /**
     * æ›´æ–°å­¦ä¹ è®°å½•
     */
    @Update("UPDATE word_study_record SET end_time = #{endTime}, end_id = #{endId}, status = #{status}, update_time = #{updateTime} " +
            "WHERE id = #{id}")
    int updateStudyRecord(WordStudyRecord record);
    
    /**
     * æ›´æ–°å¤ä¹ å®Œæˆæ—¶é—´
     */
    @Update("UPDATE word_study_record SET round_${reviewRound}_review_time = #{completedTime}, update_time = NOW() " +
            "WHERE id = #{sessionId}")
    int updateReviewTime(@Param("sessionId") Long sessionId, 
                        @Param("reviewRound") Integer reviewRound, 
                        @Param("completedTime") LocalDateTime completedTime);
    
    /**
     * æ ¹æ®IDæŸ¥è¯¢å­¦ä¹ è®°å½•
     */
    @Select("SELECT * FROM word_study_record WHERE id = #{id}")
    WordStudyRecord selectById(Long id);
    
    /**
     * æŸ¥è¯¢ç”¨æˆ·ä»Šæ—¥å­¦ä¹ è®°å½•
     */
    @Select("SELECT * FROM word_study_record WHERE user_id = #{userId} AND DATE(create_time) = CURDATE() ORDER BY create_time DESC")
    List<WordStudyRecord> selectTodayRecords(Long userId);
    
    /**
     * æŸ¥è¯¢ç”¨æˆ·æœªå®Œæˆå¤ä¹ çš„è®°å½•
     */
    @Select("SELECT * FROM word_study_record WHERE user_id = #{userId} AND status = 0 " +
            "AND (round_1_review_time IS NULL OR round_2_review_time IS NULL) " +
            "AND DATE(create_time) = CURDATE()")
    List<WordStudyRecord> selectUnfinishedReviews(Long userId);
    
    /**
     * æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦æœ‰è¿›è¡Œä¸­çš„å­¦ä¹ ä¼šè¯
     */
    @Select("SELECT * FROM word_study_record WHERE user_id = #{userId} AND status = 1 ORDER BY create_time DESC LIMIT 1")
    WordStudyRecord selectActiveSession(Long userId);
}
```

### é˜¶æ®µä¸‰ï¼šå‰ç«¯ç»„ä»¶å®ç°ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

#### 3.1 å­¦ä¹ è®¡æ—¶å™¨ç»„ä»¶

**StudyTimer.vue**
```vue
<!-- æ–‡ä»¶è·¯å¾„: src/components/learning/StudyTimer.vue -->
<template>
  <div class="study-timer-container bg-white rounded-3xl shadow-lg p-6 sm:p-8">
    <!-- è®¡æ—¶å™¨æ˜¾ç¤ºåŒºåŸŸ -->
    <div class="timer-display flex flex-col items-center mb-8">
      <!-- åœ†å½¢è¿›åº¦æ¡ -->
      <div class="relative w-48 h-48 sm:w-56 sm:h-56">
        <svg class="w-full h-full transform -rotate-90" viewBox="0 0 200 200">
          <!-- èƒŒæ™¯åœ†ç¯ -->
          <circle
            cx="100"
            cy="100"
            r="90"
            stroke="#f1f5f9"
            stroke-width="8"
            fill="none"
          />
          <!-- è¿›åº¦åœ†ç¯ -->
          <circle
            cx="100"
            cy="100"
            r="90"
            stroke="#3b82f6"
            stroke-width="8"
            fill="none"
            stroke-linecap="round"
            :stroke-dasharray="circumference"
            :stroke-dashoffset="strokeDashoffset"
            class="transition-all duration-1000 ease-out"
          />
        </svg>
        
        <!-- æ—¶é—´æ˜¾ç¤º -->
        <div class="absolute inset-0 flex flex-col items-center justify-center">
          <div class="text-4xl sm:text-5xl font-bold text-slate-900 mb-2">
            {{ formatTime(remainingTime) }}
          </div>
          <div class="text-sm text-slate-500 font-medium">
            {{ timerStatus === 'running' ? 'å‰©ä½™æ—¶é—´' : 'å­¦ä¹ æ—¶é•¿' }}
          </div>
        </div>
      </div>
    </div>
    
    <!-- å­¦ä¹ è¿›åº¦ä¿¡æ¯ -->
    <div class="progress-info bg-slate-50 rounded-2xl p-4 mb-6">
      <div class="grid grid-cols-2 gap-4 text-center">
        <div>
          <div class="text-2xl font-bold text-blue-600">{{ wordsLearned }}</div>
          <div class="text-xs text-slate-500">å·²å­¦å•è¯</div>
        </div>
        <div>
          <div class="text-2xl font-bold text-emerald-600">{{ currentRange }}</div>
          <div class="text-xs text-slate-500">å­¦ä¹ èŒƒå›´</div>
        </div>
      </div>
    </div>
    
    <!-- æ§åˆ¶æŒ‰é’® -->
    <div class="timer-controls flex flex-col gap-3">
      <!-- å¼€å§‹å­¦ä¹ æŒ‰é’® -->
      <button
        v-if="timerStatus === 'idle'"
        @click="startTimer"
        :disabled="!canStart"
        class="w-full py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-2xl font-bold text-lg shadow-lg shadow-blue-500/30 hover:shadow-blue-500/40 hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
      >
        å¼€å§‹å­¦ä¹  (30åˆ†é’Ÿ)
      </button>
      
      <!-- è¿è¡Œä¸­çš„æ§åˆ¶æŒ‰é’® -->
      <div v-else-if="timerStatus === 'running'" class="flex gap-3">
        <button
          @click="pauseTimer"
          class="flex-1 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-xl font-semibold transition-colors"
        >
          æš‚åœ
        </button>
        <button
          @click="showEndConfirm = true"
          class="flex-1 py-3 bg-rose-500 hover:bg-rose-600 text-white rounded-xl font-semibold transition-colors"
        >
          æå‰ç»“æŸ
        </button>
      </div>
      
      <!-- æš‚åœçŠ¶æ€çš„æ§åˆ¶æŒ‰é’® -->
      <div v-else-if="timerStatus === 'paused'" class="flex gap-3">
        <button
          @click="resumeTimer"
          class="flex-1 py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-xl font-semibold transition-colors"
        >
          ç»§ç»­å­¦ä¹ 
        </button>
        <button
          @click="showEndConfirm = true"
          class="flex-1 py-3 bg-rose-500 hover:bg-rose-600 text-white rounded-xl font-semibold transition-colors"
        >
          ç»“æŸå­¦ä¹ 
        </button>
      </div>
      
      <!-- æ—¶é—´åˆ°äº†çš„ç»“æŸæŒ‰é’® -->
      <button
        v-else-if="timerStatus === 'finished'"
        @click="endStudySession"
        class="w-full py-4 bg-gradient-to-r from-emerald-600 to-green-600 text-white rounded-2xl font-bold text-lg shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/40 hover:-translate-y-0.5 transition-all animate-pulse"
      >
        æ ‡è®°å¹¶ç»“æŸæœ¬è½®å­¦ä¹ 
      </button>
    </div>
    
    <!-- ç»“æŸç¡®è®¤å¼¹çª— -->
    <div v-if="showEndConfirm" class="fixed inset-0 z-50 flex items-center justify-center px-4 bg-black/50">
      <div class="bg-white rounded-3xl p-6 max-w-sm w-full">
        <h3 class="text-xl font-bold text-slate-900 mb-4">ç¡®è®¤ç»“æŸå­¦ä¹ </h3>
        <p class="text-slate-600 mb-6">ç¡®å®šè¦ç»“æŸæœ¬æ¬¡å­¦ä¹ å—ï¼Ÿå­¦ä¹ è®°å½•å°†ä¼šä¿å­˜ã€‚</p>
        <div class="flex gap-3">
          <button
            @click="showEndConfirm = false"
            class="flex-1 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-colors"
          >
            å–æ¶ˆ
          </button>
          <button
            @click="confirmEndStudy"
            class="flex-1 py-3 bg-rose-500 hover:bg-rose-600 text-white rounded-xl font-semibold transition-colors"
          >
            ç¡®è®¤ç»“æŸ
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted, onUnmounted, watch } from 'vue'
import { useWordStudyStore } from '@/stores/wordStudy'
import { useWordStore } from '@/stores/word'
import { useToast } from '@/composables/useToast'

const props = defineProps({
  studyDuration: {
    type: Number,
    default: 1800 // 30åˆ†é’Ÿ
  }
})

const emit = defineEmits(['study-started', 'study-ended', 'study-paused', 'study-resumed'])

// çŠ¶æ€ç®¡ç†
const wordStudyStore = useWordStudyStore()
const wordStore = useWordStore()
const { success, error } = useToast()

// å“åº”å¼æ•°æ®
const timerStatus = ref('idle') // idle, running, paused, finished
const remainingTime = ref(props.studyDuration)
const startTime = ref(null)
const sessionId = ref(null)
const showEndConfirm = ref(false)
const timerInterval = ref(null)

// è®¡ç®—å±æ€§
const circumference = 2 * Math.PI * 90
const progress = computed(() => {
  return ((props.studyDuration - remainingTime.value) / props.studyDuration) * 100
})
const strokeDashoffset = computed(() => {
  return circumference - (progress.value / 100) * circumference
})
const canStart = computed(() => {
  return wordStore.learningRange.start && wordStore.learningRange.end
})
const wordsLearned = computed(() => {
  return Math.max(0, wordStore.currentIndex)
})
const currentRange = computed(() => {
  return `${wordStore.learningRange.start}-${wordStore.learningRange.end}`
})

// æ–¹æ³•
const formatTime = (seconds) => {
  const mins = Math.floor(seconds / 60)
  const secs = seconds % 60
  return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`
}

const startTimer = async () => {
  try {
    // è°ƒç”¨åç«¯APIå¼€å§‹å­¦ä¹ ä¼šè¯
    const response = await wordStudyStore.startStudySession({
      userId: wordStore.userId,
      startId: wordStore.learningRange.start,
      studyDuration: props.studyDuration
    })
    
    sessionId.value = response.sessionId
    startTime.value = new Date()
    timerStatus.value = 'running'
    
    // å¼€å§‹å€’è®¡æ—¶
    timerInterval.value = setInterval(() => {
      if (remainingTime.value > 0) {
        remainingTime.value--
      } else {
        // æ—¶é—´åˆ°äº†
        timerStatus.value = 'finished'
        clearInterval(timerInterval.value)
        // æ’­æ”¾æç¤ºéŸ³æˆ–éœ‡åŠ¨
        if ('vibrate' in navigator) {
          navigator.vibrate([200, 100, 200])
        }
      }
    }, 1000)
    
    emit('study-started', { sessionId: sessionId.value, startTime: startTime.value })
    success('å­¦ä¹ è®¡æ—¶å·²å¼€å§‹')
  } catch (err) {
    error('å¼€å§‹å­¦ä¹ å¤±è´¥ï¼š' + err.message)
  }
}

const pauseTimer = () => {
  if (timerInterval.value) {
    clearInterval(timerInterval.value)
    timerInterval.value = null
  }
  timerStatus.value = 'paused'
  emit('study-paused')
}

const resumeTimer = () => {
  timerStatus.value = 'running'
  timerInterval.value = setInterval(() => {
    if (remainingTime.value > 0) {
      remainingTime.value--
    } else {
      timerStatus.value = 'finished'
      clearInterval(timerInterval.value)
    }
  }, 1000)
  emit('study-resumed')
}

const endStudySession = async () => {
  await confirmEndStudy()
}

const confirmEndStudy = async () => {
  try {
    showEndConfirm.value = false
    
    if (timerInterval.value) {
      clearInterval(timerInterval.value)
      timerInterval.value = null
    }
    
    // è°ƒç”¨åç«¯APIç»“æŸå­¦ä¹ ä¼šè¯
    await wordStudyStore.endStudySession(sessionId.value, {
      endId: wordStore.learningRange.start + wordStore.currentIndex,
      actualEndTime: new Date()
    })
    
    // é‡ç½®çŠ¶æ€
    timerStatus.value = 'idle'
    remainingTime.value = props.studyDuration
    sessionId.value = null
    
    emit('study-ended')
    success('å­¦ä¹ ä¼šè¯å·²ç»“æŸï¼Œè¯·å¼€å§‹å¤ä¹ ')
  } catch (err) {
    error('ç»“æŸå­¦ä¹ å¤±è´¥ï¼š' + err.message)
  }
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  // æ£€æŸ¥æ˜¯å¦æœ‰æœªå®Œæˆçš„å­¦ä¹ ä¼šè¯
  // è¿™é‡Œå¯ä»¥ä»storeä¸­æ¢å¤çŠ¶æ€
})

onUnmounted(() => {
  if (timerInterval.value) {
    clearInterval(timerInterval.value)
  }
})

// ç›‘å¬é¡µé¢ç¦»å¼€
window.addEventListener('beforeunload', (e) => {
  if (timerStatus.value === 'running') {
    e.preventDefault()
    e.returnValue = 'æ‚¨æ­£åœ¨å­¦ä¹ ä¸­ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ'
  }
})
</script>

<style scoped>
/* åŠ¨ç”»æ•ˆæœ */
@keyframes pulse-ring {
  0% { transform: scale(1); opacity: 1; }
  100% { transform: scale(1.1); opacity: 0; }
}

.animate-pulse-ring {
  animation: pulse-ring 2s infinite;
}
</style>
```

#### 3.2 å­¦ä¹ èŒƒå›´é€‰æ‹©ç»„ä»¶

**RangeSelector.vue**
```vue
<!-- æ–‡ä»¶è·¯å¾„: src/components/learning/RangeSelector.vue -->
<template>
  <div class="range-selector">
    <!-- è§¦å‘æŒ‰é’® -->
    <div class="flex items-center gap-2">
      <button 
        @click="showModal = true"
        class="flex items-center gap-2 px-4 py-2 bg-white shadow-sm border border-slate-200 rounded-xl text-sm font-medium text-slate-600 hover:text-blue-600 hover:border-blue-200 transition-all"
      >
        <span>èŒƒå›´: {{ currentRange }}</span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
      </button>
      
      <!-- ã€ä¸‹åä¸ªã€‘å¿«æ·æŒ‰é’® -->
      <button 
        @click="nextTenWords"
        :disabled="!canGoNext"
        class="flex items-center gap-1 px-3 py-2 bg-blue-50 text-blue-600 rounded-lg text-sm font-medium hover:bg-blue-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
        title="å¿«é€Ÿåˆ‡æ¢åˆ°ä¸‹10ä¸ªå•è¯"
      >
        <span>ä¸‹åä¸ª</span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
        </svg>
      </button>
    </div>
    
    <!-- æ¨¡æ€æ¡†å†…å®¹ä¿æŒä¸å˜... -->
  </div>
</template>

<script setup>
import { ref, computed, watch } from 'vue'
import { useWordStore } from '@/stores/word'
import { useBookStore } from '@/stores/book'
import { useToast } from '@/composables/useToast'

const emit = defineEmits(['range-changed'])

// çŠ¶æ€ç®¡ç†
const wordStore = useWordStore()
const bookStore = useBookStore()
const { success, error } = useToast()

// å“åº”å¼æ•°æ®
const showModal = ref(false)
const tempRange = ref({ start: 1, end: 50 })
const rangeError = ref('')

// è®¡ç®—å±æ€§
const currentRange = computed(() => {
  return `${wordStore.learningRange.start}-${wordStore.learningRange.end}`
})

const currentBook = computed(() => bookStore.currentBook)

const canGoNext = computed(() => {
  const currentEnd = wordStore.learningRange.end
  const maxWords = currentBook.value?.wordCount || 1000
  return currentEnd + 10 <= maxWords
})

// ã€ä¸‹åä¸ªã€‘å¿«æ·åŠŸèƒ½
const nextTenWords = async () => {
  if (!canGoNext.value) {
    error('å·²ç»æ˜¯æœ€åçš„å•è¯èŒƒå›´äº†')
    return
  }
  
  try {
    const currentRange = wordStore.learningRange
    const newRange = {
      start: currentRange.end + 1,
      end: Math.min(currentRange.end + 10, currentBook.value?.wordCount || 1000)
    }
    
    // æ›´æ–°å­¦ä¹ èŒƒå›´
    wordStore.setLearningRange(newRange)
    
    // é‡æ–°åŠ è½½å•è¯
    await wordStore.fetchWords(newRange)
    
    emit('range-changed', newRange)
    success(`å·²åˆ‡æ¢åˆ°èŒƒå›´ï¼š${newRange.start}-${newRange.end}`)
  } catch (err) {
    error('åˆ‡æ¢èŒƒå›´å¤±è´¥ï¼š' + err.message)
  }
}

// å…¶ä»–æ–¹æ³•ä¿æŒä¸å˜...
</script>
```
    
    <!-- æ¨¡æ€æ¡† -->
    <div v-if="showModal" class="fixed inset-0 z-50 flex items-center justify-center px-4">
      <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm" @click="closeModal"></div>
      <div class="relative w-full max-w-lg bg-white rounded-3xl shadow-2xl p-6 sm:p-8">
        <!-- æ ‡é¢˜ -->
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-slate-900">è®¾ç½®å­¦ä¹ èŒƒå›´</h3>
          <button @click="closeModal" class="p-2 text-slate-400 hover:text-slate-600 rounded-full hover:bg-slate-100">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        
        <!-- å½“å‰è¯¾æœ¬ä¿¡æ¯ -->
        <div class="bg-blue-50 rounded-2xl p-5 mb-6 text-sm text-blue-800">
          <div class="flex justify-between mb-2">
            <span class="opacity-70">è¯¾æœ¬åç§°</span>
            <span class="font-bold">{{ currentBook?.bookName || 'æœªé€‰æ‹©' }}</span>
          </div>
          <div class="flex justify-between mb-2">
            <span class="opacity-70">æ€»è¯æ±‡é‡</span>
            <span class="font-bold">{{ currentBook?.wordCount || 0 }} è¯</span>
          </div>
          <div class="flex justify-between">
            <span class="opacity-70">å½“å‰å·²é€‰</span>
            <span class="font-bold">{{ selectedCount }} è¯</span>
          </div>
        </div>
        
        <!-- èŒƒå›´è¾“å…¥ -->
        <div class="flex gap-4 mb-6">
          <div class="flex-1">
            <label class="block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">èµ·å§‹ä½ç½®</label>
            <input 
              v-model.number="tempRange.start"
              type="number" 
              :min="1"
              :max="currentBook?.wordCount || 1000"
              class="w-full px-4 py-3 bg-slate-50 border-2 border-slate-100 rounded-xl focus:outline-none focus:border-blue-500 focus:bg-white transition-all font-semibold text-slate-900 text-center"
              @input="validateRange"
            />
          </div>
          <div class="flex items-end pb-4 text-slate-300">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </div>
          <div class="flex-1">
            <label class="block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">ç»“æŸä½ç½®</label>
            <input 
              v-model.number="tempRange.end"
              type="number" 
              :min="tempRange.start || 1"
              :max="currentBook?.wordCount || 1000"
              class="w-full px-4 py-3 bg-slate-50 border-2 border-slate-100 rounded-xl focus:outline-none focus:border-blue-500 focus:bg-white transition-all font-semibold text-slate-900 text-center"
              @input="validateRange"
            />
          </div>
        </div>
        
        <!-- å¿«é€Ÿé€‰æ‹© -->
        <div class="mb-8">
          <label class="block text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">å¿«é€Ÿé€‰æ‹©</label>
          <div class="grid grid-cols-2 sm:grid-cols-4 gap-2">
            <button 
              v-for="(range, idx) in quickRanges" 
              :key="idx"
              @click="setQuickRange(range.start, range.end)"
              :disabled="range.end > (currentBook?.wordCount || 0)"
              class="px-3 py-2 text-xs font-medium rounded-lg border transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
              :class="isCurrentRange(range) ? 'border-blue-500 bg-blue-50 text-blue-600' : 'border-slate-200 text-slate-600 hover:border-blue-300 hover:bg-blue-50 hover:text-blue-600'"
            >
              {{ range.label }}
            </button>
          </div>
        </div>
        
        <!-- é”™è¯¯æç¤º -->
        <div v-if="rangeError" class="mb-6 p-3 bg-rose-50 border border-rose-200 rounded-xl text-rose-600 text-sm">
          {{ rangeError }}
        </div>
        
        <!-- æ“ä½œæŒ‰é’® -->
        <div class="flex gap-3">
          <button 
            @click="closeModal" 
            class="flex-1 px-6 py-3.5 rounded-xl font-semibold text-slate-600 bg-slate-100 hover:bg-slate-200 transition-colors"
          >
            å–æ¶ˆ
          </button>
          <button 
            @click="applyRange" 
            :disabled="!isValidRange"
            class="flex-1 px-6 py-3.5 rounded-xl font-bold text-white bg-blue-600 hover:bg-blue-700 shadow-lg shadow-blue-500/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
          >
            ç¡®è®¤åº”ç”¨
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, watch } from 'vue'
import { useWordStore } from '@/stores/word'
import { useBookStore } from '@/stores/book'
import { useToast } from '@/composables/useToast'

const emit = defineEmits(['range-changed'])

// çŠ¶æ€ç®¡ç†
const wordStore = useWordStore()
const bookStore = useBookStore()
const { success, error } = useToast()

// å“åº”å¼æ•°æ®
const showModal = ref(false)
const tempRange = ref({ start: 1, end: 50 })
const rangeError = ref('')

// è®¡ç®—å±æ€§
const currentRange = computed(() => {
  return `${wordStore.learningRange.start}-${wordStore.learningRange.end}`
})

const currentBook = computed(() => bookStore.currentBook)

const selectedCount = computed(() => {
  return Math.max(0, tempRange.value.end - tempRange.value.start + 1)
})

const isValidRange = computed(() => {
  return tempRange.value.start >= 1 && 
         tempRange.value.end >= tempRange.value.start && 
         tempRange.value.end <= (currentBook.value?.wordCount || 1000) &&
         !rangeError.value
})

// å¿«é€Ÿé€‰æ‹©èŒƒå›´
const quickRanges = computed(() => [
  { label: '1-50', start: 1, end: 50 },
  { label: '51-100', start: 51, end: 100 },
  { label: '101-200', start: 101, end: 200 },
  { label: '201-300', start: 201, end: 300 },
  { label: '301-400', start: 301, end: 400 },
  { label: '401-500', start: 401, end: 500 },
  { label: '501-600', start: 501, end: 600 },
  { label: '601-700', start: 601, end: 700 }
])

// æ–¹æ³•
const validateRange = () => {
  rangeError.value = ''
  
  if (tempRange.value.start < 1) {
    rangeError.value = 'èµ·å§‹ä½ç½®ä¸èƒ½å°äº1'
    return
  }
  
  if (tempRange.value.end < tempRange.value.start) {
    rangeError.value = 'ç»“æŸä½ç½®ä¸èƒ½å°äºèµ·å§‹ä½ç½®'
    return
  }
  
  if (currentBook.value?.wordCount && tempRange.value.end > currentBook.value.wordCount) {
    rangeError.value = `ç»“æŸä½ç½®ä¸èƒ½è¶…è¿‡è¯¾æœ¬æ€»è¯æ±‡é‡(${currentBook.value.wordCount})`
    return
  }
  
  if (selectedCount.value > 200) {
    rangeError.value = 'å•æ¬¡å­¦ä¹ èŒƒå›´ä¸å»ºè®®è¶…è¿‡200ä¸ªå•è¯'
    return
  }
}

const setQuickRange = (start, end) => {
  tempRange.value.start = start
  tempRange.value.end = Math.min(end, currentBook.value?.wordCount || end)
  validateRange()
}

const isCurrentRange = (range) => {
  return tempRange.value.start === range.start && tempRange.value.end === range.end
}

const applyRange = async () => {
  if (!isValidRange.value) return
  
  try {
    // æ›´æ–°storeä¸­çš„å­¦ä¹ èŒƒå›´
    wordStore.setLearningRange(tempRange.value)
    
    // é‡æ–°åŠ è½½å•è¯
    await wordStore.fetchWords(tempRange.value)
    
    showModal.value = false
    emit('range-changed', tempRange.value)
    success(`å·²è®¾ç½®å­¦ä¹ èŒƒå›´ï¼š${tempRange.value.start}-${tempRange.value.end}`)
  } catch (err) {
    error('è®¾ç½®å­¦ä¹ èŒƒå›´å¤±è´¥ï¼š' + err.message)
  }
}

const closeModal = () => {
  showModal.value = false
  // é‡ç½®ä¸ºå½“å‰èŒƒå›´
  tempRange.value = { ...wordStore.learningRange }
  rangeError.value = ''
}

// ç›‘å¬å™¨
watch(() => wordStore.learningRange, (newRange) => {
  tempRange.value = { ...newRange }
}, { immediate: true })

watch(tempRange, validateRange, { deep: true })
</script>
```

#### 3.3 çŠ¶æ€é”å®šæ£€æŸ¥ç»„ä»¶

**StudyLockGuard.vue**
```vue
<!-- æ–‡ä»¶è·¯å¾„: src/components/common/StudyLockGuard.vue -->
<template>
  <!-- å…¨å±€é”å®šé®ç½© -->
  <div v-if="isLocked" class="fixed inset-0 z-50 flex items-center justify-center px-4 bg-slate-900/80 backdrop-blur-sm">
    <div class="bg-white rounded-3xl shadow-2xl p-6 sm:p-8 max-w-md w-full">
      <!-- è­¦å‘Šå›¾æ ‡ -->
      <div class="flex justify-center mb-6">
        <div class="w-20 h-20 bg-amber-100 rounded-full flex items-center justify-center">
          <svg class="w-10 h-10 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
          </svg>
        </div>
      </div>
      
      <!-- æ ‡é¢˜å’Œæè¿° -->
      <div class="text-center mb-8">
        <h3 class="text-2xl font-bold text-slate-900 mb-3">å¤ä¹ æé†’</h3>
        <p class="text-slate-600 leading-relaxed">
          {{ lockStatus.message || 'æ‚¨æœ‰æœªå®Œæˆçš„å¤ä¹ ä»»åŠ¡ï¼Œè¯·å…ˆå®Œæˆç¬¬ä¸€ã€äºŒè½®å¤ä¹ ï¼' }}
        </p>
      </div>
      
      <!-- å¾…å®Œæˆå¤ä¹ åˆ—è¡¨ -->
      <div v-if="pendingReviews.length > 0" class="mb-8">
        <h4 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-3">å¾…å®Œæˆå¤ä¹ </h4>
        <div class="space-y-3">
          <div 
            v-for="review in pendingReviews" 
            :key="review.sessionId"
            class="flex items-center justify-between p-3 bg-slate-50 rounded-xl"
          >
            <div>
              <div class="font-semibold text-slate-900">{{ review.range }}</div>
              <div class="text-xs text-slate-500">{{ formatDate(review.createTime) }}</div>
            </div>
            <div class="text-xs font-bold text-amber-600 bg-amber-100 px-2 py-1 rounded-full">
              ç¬¬{{ review.pendingRound }}è½®
            </div>
          </div>
        </div>
      </div>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <div class="space-y-3">
        <button 
          @click="goToReview"
          class="w-full py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-2xl font-bold text-lg shadow-lg shadow-blue-500/30 hover:shadow-blue-500/40 hover:-translate-y-0.5 transition-all"
        >
          è¿›å…¥å¤ä¹ ä¸­å¿ƒ
        </button>
        
        <button 
          v-if="lockStatus.allowedActions?.includes('JOTTINGS')"
          @click="goToJottings"
          class="w-full py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold transition-colors"
        >
          ä½¿ç”¨ç§¯ç´¯æœ¬
        </button>
      </div>
      
      <!-- åŠŸèƒ½é™åˆ¶è¯´æ˜ -->
      <div class="mt-6 p-3 bg-rose-50 border border-rose-200 rounded-xl">
        <div class="text-xs font-bold text-rose-600 mb-1">åŠŸèƒ½é™åˆ¶è¯´æ˜</div>
        <div class="text-xs text-rose-600">
          å®Œæˆå¤ä¹ å‰ï¼Œæ–°è¯å­¦ä¹ ã€æ¸¸æˆç­‰åŠŸèƒ½å°†è¢«é”å®š
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted, onUnmounted } from 'vue'
import { useRouter } from 'vue-router'
import { useWordStudyStore } from '@/stores/wordStudy'
import { useAuthStore } from '@/stores/auth'

const router = useRouter()
const wordStudyStore = useWordStudyStore()
const authStore = useAuthStore()

// å“åº”å¼æ•°æ®
const lockStatus = ref({})
const pendingReviews = ref([])
const checkInterval = ref(null)

// è®¡ç®—å±æ€§
const isLocked = computed(() => lockStatus.value.isLocked)

// æ–¹æ³•
const checkLockStatus = async () => {
  try {
    if (!authStore.user?.id) return
    
    const response = await wordStudyStore.checkLockStatus(authStore.user.id)
    lockStatus.value = response
    
    if (response.pendingReviews) {
      pendingReviews.value = response.pendingReviews
    }
  } catch (error) {
    console.error('æ£€æŸ¥é”å®šçŠ¶æ€å¤±è´¥:', error)
  }
}

const goToReview = () => {
  router.push('/word/review')
}

const goToJottings = () => {
  router.push('/jottings')
}

const formatDate = (dateString) => {
  const date = new Date(dateString)
  return date.toLocaleString('zh-CN', {
    month: 'short',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  })
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  checkLockStatus()
  // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡é”å®šçŠ¶æ€
  checkInterval.value = setInterval(checkLockStatus, 30000)
})

onUnmounted(() => {
  if (checkInterval.value) {
    clearInterval(checkInterval.value)
  }
})

// æš´éœ²æ–¹æ³•ç»™çˆ¶ç»„ä»¶
defineExpose({
  checkLockStatus
})
</script>
```

### é˜¶æ®µå››ï¼šé¡µé¢åŠŸèƒ½å¢å¼ºï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

#### 4.1 å•è¯å­¦ä¹ é¡µé¢æ”¹é€ 
- [ ] é›†æˆ30åˆ†é’Ÿè®¡æ—¶å™¨
- [ ] æ·»åŠ å­¦ä¹ ä¼šè¯ç®¡ç†
- [ ] å®ç°å¼ºåˆ¶ç»“æŸæœºåˆ¶
- [ ] æ·»åŠ å­¦ä¹ è®°å½•ä¿å­˜

#### 4.2 å¤ä¹ é¡µé¢æ”¹é€ 
- [ ] ç¬¬ä¸€è½®å¤ä¹ é¡µé¢å¢å¼º
- [ ] ç¬¬äºŒè½®å¤ä¹ é¡µé¢å¢å¼º
- [ ] å¤ä¹ å®Œæˆæ ‡è®°åŠŸèƒ½
- [ ] å¤ä¹ è¿›åº¦è·Ÿè¸ª

#### 4.3 å…¨å±€çŠ¶æ€ç®¡ç†
- [ ] å­¦ä¹ é”å®šçŠ¶æ€ç®¡ç†
- [ ] å¤ä¹ ä»»åŠ¡çŠ¶æ€ç®¡ç†
- [ ] å­¦ä¹ ä¼šè¯çŠ¶æ€ç®¡ç†

### é˜¶æ®µäº”ï¼šç³»ç»Ÿé›†æˆä¸æµ‹è¯•ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

#### 5.1 è·¯ç”±å®ˆå«é›†æˆ
- [ ] å…¨å±€è·¯ç”±æ‹¦æˆªå™¨
- [ ] å­¦ä¹ çŠ¶æ€æ£€æŸ¥
- [ ] åŠŸèƒ½é”å®šé€»è¾‘

#### 5.2 å®šæ—¶ä»»åŠ¡å®ç°
- [ ] æ¯æ—¥å‡Œæ™¨2ç‚¹å­¦ä¹ æ¸…å•ç”Ÿæˆ
- [ ] å­¦ä¹ ä¼šè¯è¶…æ—¶å¤„ç†
- [ ] æ•°æ®æ¸…ç†ä»»åŠ¡

## ğŸ”Œ æ¥å£è®¾è®¡è¯¦æƒ…

### 1. å­¦ä¹ ä¼šè¯ç®¡ç†æ¥å£

#### å¼€å§‹å­¦ä¹ ä¼šè¯
```http
POST /api/word-study/start
Content-Type: application/json

{
  "userId": 1,
  "bookId": 1,
  "startId": 1,
  "studyDuration": 1800  // 30åˆ†é’Ÿï¼Œå•ä½ç§’
}

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "sessionId": 123,
    "startTime": "2026-01-08T10:00:00",
    "expectedEndTime": "2026-01-08T10:30:00"
  }
}
```

#### ç»“æŸå­¦ä¹ ä¼šè¯
```http
POST /api/word-study/end/123
Content-Type: application/json

{
  "endId": 50,
  "actualEndTime": "2026-01-08T10:30:00"
}

Response:
{
  "code": 200,
  "message": "å­¦ä¹ ä¼šè¯å·²ç»“æŸï¼Œè¯·å¼€å§‹ç¬¬ä¸€è½®å¤ä¹ ",
  "data": {
    "wordsLearned": 50,
    "timeSpent": 1800,
    "nextAction": "REVIEW_ROUND_1"
  }
}
```

### 2. å¤ä¹ çŠ¶æ€æ£€æŸ¥æ¥å£

#### æ£€æŸ¥å¤ä¹ çŠ¶æ€
```http
GET /api/word-study/review-status/1

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "hasUnfinishedReview": true,
    "pendingRounds": [1, 2],
    "lockStatus": "LOCKED",
    "lastStudySession": {
      "id": 123,
      "startId": 1,
      "endId": 50,
      "createTime": "2026-01-08T10:00:00"
    }
  }
}
```

#### æ ‡è®°å¤ä¹ å®Œæˆ
```http
POST /api/word-study/review/complete
Content-Type: application/json

{
  "userId": 1,
  "sessionId": 123,
  "reviewRound": 1,
  "completedTime": "2026-01-08T11:00:00"
}

Response:
{
  "code": 200,
  "message": "ç¬¬ä¸€è½®å¤ä¹ å·²å®Œæˆ",
  "data": {
    "nextRound": 2,
    "unlocked": false,
    "message": "è¯·ç»§ç»­å®Œæˆç¬¬äºŒè½®å¤ä¹ "
  }
}
```

### 3. åŠŸèƒ½é”å®šæ£€æŸ¥æ¥å£

#### æ£€æŸ¥é”å®šçŠ¶æ€
```http
GET /api/study-lock/check/1

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "isLocked": true,
    "reason": "PENDING_REVIEW",
    "allowedActions": ["REVIEW", "JOTTINGS"],
    "blockedActions": ["NEW_STUDY", "GAMES", "SETTINGS"],
    "message": "æ‚¨æœ‰æœªå®Œæˆçš„å¤ä¹ ä»»åŠ¡ï¼Œè¯·å…ˆå®Œæˆç¬¬ä¸€ã€äºŒè½®å¤ä¹ ï¼"
  }
}
```

## ğŸ¨ å‰ç«¯UIå¸ƒå±€è®¾è®¡

### 1. å­¦ä¹ è®¡æ—¶å™¨ç»„ä»¶å¸ƒå±€
```vue
<template>
  <div class="study-timer-container">
    <!-- åœ†å½¢è¿›åº¦æ¡ -->
    <div class="timer-circle">
      <div class="time-display">25:30</div>
      <div class="timer-label">å‰©ä½™æ—¶é—´</div>
    </div>
    
    <!-- æ§åˆ¶æŒ‰é’® -->
    <div class="timer-controls">
      <button class="start-btn">å¼€å§‹å­¦ä¹ </button>
      <button class="pause-btn">æš‚åœ</button>
      <button class="end-btn">ç»“æŸå­¦ä¹ </button>
    </div>
    
    <!-- å­¦ä¹ è¿›åº¦ -->
    <div class="study-progress">
      <div class="progress-bar"></div>
      <div class="progress-text">å·²å­¦ä¹ : 25/50 è¯</div>
    </div>
  </div>
</template>
```

### 2. çŠ¶æ€é”å®šæç¤ºç»„ä»¶å¸ƒå±€
```vue
<template>
  <div class="lock-overlay" v-if="isLocked">
    <div class="lock-modal">
      <div class="warning-icon">âš ï¸</div>
      <h3>å¤ä¹ æé†’</h3>
      <p>æ‚¨æœ‰æœªå®Œæˆçš„å¤ä¹ ä»»åŠ¡ï¼Œè¯·å…ˆå®Œæˆç¬¬ä¸€ã€äºŒè½®å¤ä¹ ï¼</p>
      
      <div class="pending-reviews">
        <div class="review-item" v-for="review in pendingReviews">
          <span>{{ review.range }}</span>
          <span>{{ review.type }}</span>
        </div>
      </div>
      
      <div class="action-buttons">
        <button class="review-btn">è¿›å…¥å¤ä¹ ä¸­å¿ƒ</button>
        <button class="jottings-btn">ä½¿ç”¨ç§¯ç´¯æœ¬</button>
      </div>
    </div>
  </div>
</template>
```

### 3. å¤ä¹ å®Œæˆæ ‡è®°ç»„ä»¶å¸ƒå±€
```vue
<template>
  <div class="review-complete-section">
    <div class="review-progress">
      <div class="progress-steps">
        <div class="step completed">ç¬¬ä¸€è½®å¤ä¹ </div>
        <div class="step current">ç¬¬äºŒè½®å¤ä¹ </div>
        <div class="step">è§£é”åŠŸèƒ½</div>
      </div>
    </div>
    
    <div class="complete-actions">
      <button class="complete-btn" @click="markComplete">
        æ ‡è®°æœ¬è½®å¤ä¹ å·²å®Œæˆ
      </button>
    </div>
  </div>
</template>
```

## ğŸ“± å“åº”å¼è®¾è®¡è€ƒè™‘

### ç§»åŠ¨ç«¯é€‚é…
- è®¡æ—¶å™¨ç»„ä»¶åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨æ›´å¤§çš„è§¦æ‘¸åŒºåŸŸ
- å¤ä¹ å¡ç‰‡é‡‡ç”¨å…¨å±æ»‘åŠ¨æ¨¡å¼
- çŠ¶æ€é”å®šæç¤ºä½¿ç”¨åº•éƒ¨å¼¹çª—æ ·å¼
- æ‰€æœ‰æŒ‰é’®ç¬¦åˆç§»åŠ¨ç«¯æœ€å°44pxè§¦æ‘¸æ ‡å‡†

### å¹³æ¿ç«¯é€‚é…
- åˆ©ç”¨æ›´å¤§å±å¹•ç©ºé—´æ˜¾ç¤ºæ›´å¤šå­¦ä¹ ä¿¡æ¯
- æ”¯æŒæ¨ªå±å’Œç«–å±ä¸¤ç§å¸ƒå±€æ¨¡å¼
- å¤ä¹ é¡µé¢å¯ä»¥æ˜¾ç¤ºæ›´å¤šå•è¯å¡ç‰‡

## ğŸ”„ çŠ¶æ€æµè½¬å›¾

```
å¼€å§‹30åˆ†é’Ÿå­¦ä¹  â†’ é€‰æ‹©å­¦ä¹ èŒƒå›´ â†’ å¯åŠ¨è®¡æ—¶å™¨ â†’ å­¦ä¹ å•è¯
                                    â†“
æ£€æŸ¥å¤ä¹ çŠ¶æ€ â† ä¿å­˜å­¦ä¹ è®°å½• â† 30åˆ†é’Ÿç»“æŸ â† å¼ºåˆ¶ç»“æŸå­¦ä¹ 
    â†“
åŠŸèƒ½é”å®š â†’ è¿›å…¥å¤ä¹ ä¸­å¿ƒ â†’ ç¬¬ä¸€è½®å¤ä¹  â†’ æ ‡è®°å®Œæˆ
    â†“                              â†“
è§£é”æ£€æŸ¥ â† ç¬¬äºŒè½®å¤ä¹ å®Œæˆ â† ç¬¬äºŒè½®å¤ä¹  â† ç»§ç»­å¤ä¹ 
    â†“
å…¨åŠŸèƒ½è§£é”
```

## âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### å‰ç«¯ä¼˜åŒ–
- å­¦ä¹ ç»„ä»¶æ‡’åŠ è½½
- å¤ä¹ æ•°æ®æœ¬åœ°ç¼“å­˜
- è®¡æ—¶å™¨ä½¿ç”¨Web Workersé¿å…ä¸»çº¿ç¨‹é˜»å¡
- å›¾ç‰‡å’ŒéŸ³é¢‘èµ„æºé¢„åŠ è½½

### åç«¯ä¼˜åŒ–
- å­¦ä¹ è®°å½•æ‰¹é‡æ’å…¥
- å¤ä¹ çŠ¶æ€æŸ¥è¯¢ç¼“å­˜
- æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–
- å®šæ—¶ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œ

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
- å­¦ä¹ è®¡æ—¶å™¨é€»è¾‘æµ‹è¯•
- å¤ä¹ çŠ¶æ€æ£€æŸ¥æµ‹è¯•
- æ•°æ®åº“æ“ä½œæµ‹è¯•

### é›†æˆæµ‹è¯•
- å‰åç«¯æ¥å£è”è°ƒæµ‹è¯•
- å­¦ä¹ æµç¨‹ç«¯åˆ°ç«¯æµ‹è¯•
- çŠ¶æ€é”å®šæœºåˆ¶æµ‹è¯•

### ç”¨æˆ·ä½“éªŒæµ‹è¯•
- ä¸åŒè®¾å¤‡å“åº”å¼æµ‹è¯•
- å­¦ä¹ æµç¨‹ç”¨æˆ·ä½“éªŒæµ‹è¯•
- å¼‚å¸¸æƒ…å†µå¤„ç†æµ‹è¯•

## ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

### åç«¯å¼€å‘
- [ ] åˆ›å»ºword_study_recordè¡¨
- [ ] å®ç°WordStudyController
- [ ] å®ç°StudyLockController
- [ ] æ‰©å±•StudyRecordController
- [ ] å®ç°ç›¸å…³Serviceå±‚
- [ ] å®ç°ç›¸å…³Mapperå±‚
- [ ] æ·»åŠ å®šæ—¶ä»»åŠ¡
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•

### å‰ç«¯å¼€å‘
- [ ] åˆ›å»ºStudyTimerç»„ä»¶
- [ ] åˆ›å»ºRangeSelectorç»„ä»¶
- [ ] åˆ›å»ºStudyLockGuardç»„ä»¶
- [ ] æ”¹é€ WordLearningé¡µé¢
- [ ] æ”¹é€ WordReviewé¡µé¢
- [ ] å®ç°çŠ¶æ€ç®¡ç†Store
- [ ] æ·»åŠ è·¯ç”±å®ˆå«
- [ ] ç¼–å†™ç»„ä»¶æµ‹è¯•

### ç³»ç»Ÿé›†æˆ
- [ ] å‰åç«¯æ¥å£è”è°ƒ
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬
- [ ] ç³»ç»Ÿé…ç½®æ–‡ä»¶
- [ ] éƒ¨ç½²è„šæœ¬
- [ ] ç›‘æ§å’Œæ—¥å¿—
- [ ] ç”¨æˆ·æ–‡æ¡£

## ğŸš€ éƒ¨ç½²å’Œä¸Šçº¿

### å¼€å‘ç¯å¢ƒ
- æœ¬åœ°MySQLæ•°æ®åº“é…ç½®
- å‰ç«¯å¼€å‘æœåŠ¡å™¨é…ç½®
- åç«¯Spring Booté…ç½®
- è·¨åŸŸå’Œä»£ç†é…ç½®

### ç”Ÿäº§ç¯å¢ƒ
- æ•°æ®åº“è¿æ¥æ± é…ç½®
- é™æ€èµ„æºCDNé…ç½®
- è´Ÿè½½å‡è¡¡é…ç½®
- ç›‘æ§å’Œå‘Šè­¦é…ç½®

---

## ğŸ“ æ€»ç»“

æœ¬å®ç°æ–¹æ¡ˆåŸºäºè‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿ç†è®ºï¼Œé€šè¿‡æŠ€æœ¯æ‰‹æ®µå¼ºåˆ¶ç”¨æˆ·éµå¾ªç§‘å­¦çš„å­¦ä¹ å’Œå¤ä¹ èŠ‚å¥ã€‚æ ¸å¿ƒç‰¹ç‚¹ï¼š

1. **å¼ºåˆ¶æ€§å­¦ä¹ æµç¨‹**: 30åˆ†é’Ÿå­¦ä¹ +ä¸¤è½®å¤ä¹ çš„é—­ç¯è®¾è®¡
2. **çŠ¶æ€é”å®šæœºåˆ¶**: ç¡®ä¿ç”¨æˆ·å®Œæˆå¿…è¦çš„å¤ä¹ ä»»åŠ¡
3. **æ•°æ®é©±åŠ¨**: å®Œæ•´çš„å­¦ä¹ æ•°æ®è®°å½•å’Œåˆ†æ
4. **ç”¨æˆ·ä½“éªŒ**: ç°ä»£åŒ–çš„UIè®¾è®¡å’Œå“åº”å¼å¸ƒå±€
5. **æŠ€æœ¯å¯é **: åŸºäºæˆç†Ÿçš„æŠ€æœ¯æ ˆå’Œæœ€ä½³å®è·µ

é€šè¿‡åˆ†é˜¶æ®µå®æ–½ï¼Œç¡®ä¿æ¯ä¸ªåŠŸèƒ½æ¨¡å—éƒ½ç»è¿‡å……åˆ†æµ‹è¯•å’ŒéªŒè¯ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªå®Œæ•´ã€å¯é çš„è‹±è¯­å­¦ä¹ ç³»ç»Ÿã€‚

#### 3.4 å‰ç«¯çŠ¶æ€ç®¡ç†Store

**wordStudy.js**
```javascript
// æ–‡ä»¶è·¯å¾„: src/stores/wordStudy.js
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { wordStudyService } from '@/services/wordStudy.service'

export const useWordStudyStore = defineStore('wordStudy', () => {
  // çŠ¶æ€
  const currentSession = ref(null)
  const lockStatus = ref({})
  const pendingReviews = ref([])
  const loading = ref(false)
  
  // è®¡ç®—å±æ€§
  const isLocked = computed(() => lockStatus.value.isLocked)
  const hasActiveSession = computed(() => currentSession.value && currentSession.value.status === 1)
  
  // åŠ¨ä½œ
  const startStudySession = async (request) => {
    try {
      loading.value = true
      const response = await wordStudyService.startSession(request)
      currentSession.value = response.data
      return response.data
    } catch (error) {
      console.error('å¼€å§‹å­¦ä¹ ä¼šè¯å¤±è´¥:', error)
      throw error
    } finally {
      loading.value = false
    }
  }
  
  const endStudySession = async (sessionId, request) => {
    try {
      loading.value = true
      const response = await wordStudyService.endSession(sessionId, request)
      currentSession.value = null
      // ç»“æŸåæ£€æŸ¥é”å®šçŠ¶æ€
      await checkLockStatus(request.userId)
      return response.data
    } catch (error) {
      console.error('ç»“æŸå­¦ä¹ ä¼šè¯å¤±è´¥:', error)
      throw error
    } finally {
      loading.value = false
    }
  }
  
  const checkLockStatus = async (userId) => {
    try {
      const response = await wordStudyService.checkLockStatus(userId)
      lockStatus.value = response.data
      pendingReviews.value = response.data.pendingReviews || []
      return response.data
    } catch (error) {
      console.error('æ£€æŸ¥é”å®šçŠ¶æ€å¤±è´¥:', error)
      throw error
    }
  }
  
  const markReviewComplete = async (request) => {
    try {
      loading.value = true
      const response = await wordStudyService.markReviewComplete(request)
      // æ ‡è®°å®Œæˆåé‡æ–°æ£€æŸ¥é”å®šçŠ¶æ€
      await checkLockStatus(request.userId)
      return response.data
    } catch (error) {
      console.error('æ ‡è®°å¤ä¹ å®Œæˆå¤±è´¥:', error)
      throw error
    } finally {
      loading.value = false
    }
  }
  
  const getTodayRecords = async (userId) => {
    try {
      const response = await wordStudyService.getTodayRecords(userId)
      return response.data
    } catch (error) {
      console.error('è·å–ä»Šæ—¥å­¦ä¹ è®°å½•å¤±è´¥:', error)
      throw error
    }
  }
  
  const resetState = () => {
    currentSession.value = null
    lockStatus.value = {}
    pendingReviews.value = []
  }
  
  return {
    // çŠ¶æ€
    currentSession,
    lockStatus,
    pendingReviews,
    loading,
    
    // è®¡ç®—å±æ€§
    isLocked,
    hasActiveSession,
    
    // åŠ¨ä½œ
    startStudySession,
    endStudySession,
    checkLockStatus,
    markReviewComplete,
    getTodayRecords,
    resetState
  }
})
```

**wordStudy.service.js**
```javascript
// æ–‡ä»¶è·¯å¾„: src/services/wordStudy.service.js
import { api } from './api'

export const wordStudyService = {
  // å¼€å§‹å­¦ä¹ ä¼šè¯
  startSession(request) {
    return api.post('/word-study/start', request)
  },
  
  // ç»“æŸå­¦ä¹ ä¼šè¯
  endSession(sessionId, request) {
    return api.post(`/word-study/end/${sessionId}`, request)
  },
  
  // æ£€æŸ¥å¤ä¹ çŠ¶æ€
  checkReviewStatus(userId) {
    return api.get(`/word-study/review-status/${userId}`)
  },
  
  // æ ‡è®°å¤ä¹ å®Œæˆ
  markReviewComplete(request) {
    return api.post('/word-study/review/complete', request)
  },
  
  // è·å–ä»Šæ—¥å­¦ä¹ è®°å½•
  getTodayRecords(userId) {
    return api.get(`/word-study/today-records/${userId}`)
  },
  
  // æ£€æŸ¥é”å®šçŠ¶æ€
  checkLockStatus(userId) {
    return api.get(`/study-lock/check/${userId}`)
  },
  
  // è·å–å¾…å®Œæˆå¤ä¹ ä»»åŠ¡
  getPendingReviews(userId) {
    return api.get(`/study-lock/pending-reviews/${userId}`)
  }
}
```

### é˜¶æ®µå››ï¼šé¡µé¢åŠŸèƒ½å¢å¼ºï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

#### 4.1 å•è¯å­¦ä¹ é¡µé¢æ”¹é€ 

**WordLearning.vue ä¸»è¦ä¿®æ”¹ç‚¹ï¼š**

1. **é›†æˆå­¦ä¹ è®¡æ—¶å™¨ç»„ä»¶**
```vue
<template>
  <div class="word-learning-page">
    <!-- ç°æœ‰çš„å¯¼èˆªæ  -->
    
    <!-- æ–°å¢ï¼šå­¦ä¹ è®¡æ—¶å™¨åŒºåŸŸ -->
    <div class="timer-section mb-6">
      <StudyTimer 
        @study-started="onStudyStarted"
        @study-ended="onStudyEnded"
        @study-paused="onStudyPaused"
        @study-resumed="onStudyResumed"
      />
    </div>
    
    <!-- ç°æœ‰çš„å•è¯å¡ç‰‡åŒºåŸŸ -->
    <div class="word-card-section">
      <!-- ç°æœ‰å†…å®¹ä¿æŒä¸å˜ -->
    </div>
    
    <!-- ä¿®æ”¹ï¼šåº•éƒ¨æ§åˆ¶æ å¢åŠ å­¦ä¹ çŠ¶æ€æ˜¾ç¤º -->
    <div class="bottom-controls">
      <!-- å­¦ä¹ è¿›åº¦æ˜¾ç¤º -->
      <div class="study-progress mb-4">
        <div class="text-sm text-slate-500 mb-2">
          æœ¬è½®å­¦ä¹ è¿›åº¦: {{ currentIndex + 1 }} / {{ totalWords }}
        </div>
        <div class="w-full bg-slate-200 rounded-full h-2">
          <div 
            class="bg-blue-500 h-2 rounded-full transition-all duration-300"
            :style="{ width: `${(currentIndex + 1) / totalWords * 100}%` }"
          ></div>
        </div>
      </div>
      
      <!-- ç°æœ‰çš„å¯¼èˆªæŒ‰é’® -->
    </div>
  </div>
</template>

<script setup>
import StudyTimer from '@/components/learning/StudyTimer.vue'
import { useWordStudyStore } from '@/stores/wordStudy'

const wordStudyStore = useWordStudyStore()

// å­¦ä¹ ä¼šè¯äº‹ä»¶å¤„ç†
const onStudyStarted = (data) => {
  console.log('å­¦ä¹ å¼€å§‹:', data)
  // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ä¸€äº›UIåé¦ˆ
}

const onStudyEnded = () => {
  console.log('å­¦ä¹ ç»“æŸ')
  // æ˜¾ç¤ºå¤ä¹ æç¤º
  showReviewPrompt()
}

const showReviewPrompt = () => {
  // æ˜¾ç¤ºå¤ä¹ æç¤ºå¼¹çª—æˆ–è·³è½¬åˆ°å¤ä¹ é¡µé¢
}
</script>
```

2. **æ·»åŠ å­¦ä¹ èŒƒå›´ç®¡ç†**
```vue
<!-- åœ¨å¯¼èˆªæ ä¸­é›†æˆèŒƒå›´é€‰æ‹©å™¨ -->
<div class="nav-controls">
  <RangeSelector @range-changed="onRangeChanged" />
</div>

<script>
import RangeSelector from '@/components/learning/RangeSelector.vue'

const onRangeChanged = (newRange) => {
  console.log('å­¦ä¹ èŒƒå›´å·²æ›´æ”¹:', newRange)
  // é‡æ–°åŠ è½½å•è¯æ•°æ®
}
</script>
```

#### 4.2 å¤ä¹ é¡µé¢æ”¹é€ 

**WordReview.vue ä¸»è¦ä¿®æ”¹ç‚¹ï¼š**

1. **æ·»åŠ å¤ä¹ å®Œæˆæ ‡è®°åŠŸèƒ½**
```vue
<template>
  <div class="word-review-page">
    <!-- ç°æœ‰çš„å¤ä¹ å†…å®¹ -->
    
    <!-- æ–°å¢ï¼šå¤ä¹ è¿›åº¦æ˜¾ç¤º -->
    <div class="review-progress mb-6">
      <div class="flex items-center justify-between mb-2">
        <span class="text-sm font-medium text-slate-600">ç¬¬ä¸€è½®å¤ä¹ è¿›åº¦</span>
        <span class="text-sm font-bold text-blue-600">{{ reviewProgress }}%</span>
      </div>
      <div class="w-full bg-slate-200 rounded-full h-2">
        <div 
          class="bg-blue-500 h-2 rounded-full transition-all duration-300"
          :style="{ width: `${reviewProgress}%` }"
        ></div>
      </div>
    </div>
    
    <!-- ç°æœ‰çš„å¤ä¹ å¡ç‰‡ -->
    
    <!-- æ–°å¢ï¼šå¤ä¹ å®ŒæˆæŒ‰é’® -->
    <div class="review-complete-section mt-8">
      <button 
        @click="markReviewComplete"
        :disabled="!canComplete"
        class="w-full py-4 bg-gradient-to-r from-emerald-600 to-green-600 text-white rounded-2xl font-bold text-lg shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/40 hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
      >
        æ ‡è®°ç¬¬ä¸€è½®å¤ä¹ å·²å®Œæˆ
      </button>
      
      <div class="mt-4 text-center text-sm text-slate-500">
        å®Œæˆåå°†è§£é”ç¬¬äºŒè½®å¤ä¹ 
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'
import { useWordStudyStore } from '@/stores/wordStudy'
import { useAuthStore } from '@/stores/auth'
import { useRouter } from 'vue-router'
import { useToast } from '@/composables/useToast'

const wordStudyStore = useWordStudyStore()
const authStore = useAuthStore()
const router = useRouter()
const { success, error } = useToast()

const reviewedCount = ref(0)
const totalReviewWords = ref(0)

const reviewProgress = computed(() => {
  if (totalReviewWords.value === 0) return 0
  return Math.round((reviewedCount.value / totalReviewWords.value) * 100)
})

const canComplete = computed(() => {
  return reviewProgress.value >= 80 // è‡³å°‘å®Œæˆ80%æ‰èƒ½æ ‡è®°å®Œæˆ
})

const markReviewComplete = async () => {
  try {
    await wordStudyStore.markReviewComplete({
      userId: authStore.user.id,
      sessionId: getCurrentSessionId(), // éœ€è¦è·å–å½“å‰ä¼šè¯ID
      reviewRound: 1,
      completedTime: new Date()
    })
    
    success('ç¬¬ä¸€è½®å¤ä¹ å·²å®Œæˆï¼')
    router.push('/word/review') // è·³è½¬åˆ°å¤ä¹ é€‰æ‹©é¡µé¢
  } catch (err) {
    error('æ ‡è®°å¤ä¹ å®Œæˆå¤±è´¥ï¼š' + err.message)
  }
}
</script>
```

#### 4.3 å…¨å±€è·¯ç”±å®ˆå«é›†æˆ

**router/index.js ä¿®æ”¹ï¼š**
```javascript
import { useWordStudyStore } from '@/stores/wordStudy'

// åœ¨ç°æœ‰çš„è·¯ç”±å®ˆå«ä¸­æ·»åŠ é”å®šæ£€æŸ¥
router.beforeEach(async (to, from, next) => {
  const authStore = useAuthStore()
  const wordStudyStore = useWordStudyStore()
  
  // ç°æœ‰çš„è®¤è¯æ£€æŸ¥...
  
  // æ–°å¢ï¼šå­¦ä¹ é”å®šæ£€æŸ¥
  if (to.meta.requiresAuth && authStore.isAuthenticated) {
    try {
      const lockStatus = await wordStudyStore.checkLockStatus(authStore.user.id)
      
      // å¦‚æœåŠŸèƒ½è¢«é”å®šä¸”ä¸æ˜¯å…è®¸çš„é¡µé¢
      if (lockStatus.isLocked && !isAllowedRoute(to.name, lockStatus.allowedActions)) {
        // å¦‚æœæ˜¯å¤ä¹ ç›¸å…³é¡µé¢ï¼Œå…è®¸é€šè¿‡
        if (to.name.includes('Review') || to.name === 'Jottings') {
          next()
          return
        }
        
        // å¦åˆ™æ˜¾ç¤ºé”å®šæç¤ºï¼ˆé€šè¿‡å…¨å±€ç»„ä»¶å¤„ç†ï¼‰
        next(false)
        return
      }
    } catch (error) {
      console.error('æ£€æŸ¥å­¦ä¹ é”å®šçŠ¶æ€å¤±è´¥:', error)
    }
  }
  
  next()
})

// è¾…åŠ©å‡½æ•°ï¼šæ£€æŸ¥è·¯ç”±æ˜¯å¦è¢«å…è®¸
const isAllowedRoute = (routeName, allowedActions) => {
  const routeActionMap = {
    'WordReview': 'REVIEW',
    'WordReviewSelection': 'REVIEW', 
    'Jottings': 'JOTTINGS',
    'Home': 'HOME'
  }
  
  const requiredAction = routeActionMap[routeName]
  return !requiredAction || allowedActions.includes(requiredAction)
}
```

### é˜¶æ®µäº”ï¼šç³»ç»Ÿé›†æˆä¸æµ‹è¯•ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

#### 5.1 å®šæ—¶ä»»åŠ¡å®ç°

**StudyTaskScheduler.java**
```java
package com.austain.srevice;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Service;

/**
 * å­¦ä¹ ä»»åŠ¡å®šæ—¶è°ƒåº¦å™¨
 */
@Service
public class StudyTaskScheduler {
    
    @Autowired
    private WordStudyService wordStudyService;
    
    /**
     * æ¯æ—¥å‡Œæ™¨2ç‚¹ç”Ÿæˆå­¦ä¹ æ¸…å•
     */
    @Scheduled(cron = "0 0 2 * * ?")
    public void generateDailyLearningChecklist() {
        System.out.println("å¼€å§‹ç”Ÿæˆæ¯æ—¥å­¦ä¹ æ¸…å•...");
        try {
            wordStudyService.generateDailyChecklist();
            System.out.println("æ¯æ—¥å­¦ä¹ æ¸…å•ç”Ÿæˆå®Œæˆ");
        } catch (Exception e) {
            System.err.println("ç”Ÿæˆæ¯æ—¥å­¦ä¹ æ¸…å•å¤±è´¥: " + e.getMessage());
        }
    }
    
    /**
     * æ¯å°æ—¶æ£€æŸ¥è¶…æ—¶çš„å­¦ä¹ ä¼šè¯
     */
    @Scheduled(cron = "0 0 * * * ?")
    public void checkTimeoutSessions() {
        System.out.println("æ£€æŸ¥è¶…æ—¶å­¦ä¹ ä¼šè¯...");
        try {
            wordStudyService.handleTimeoutSessions();
            System.out.println("è¶…æ—¶ä¼šè¯å¤„ç†å®Œæˆ");
        } catch (Exception e) {
            System.err.println("å¤„ç†è¶…æ—¶ä¼šè¯å¤±è´¥: " + e.getMessage());
        }
    }
}
```

#### 5.2 åº”ç”¨ä¸»ç±»é…ç½®

**EnglishAndWordApplication.java ä¿®æ”¹ï¼š**
```java
package com.austain;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.scheduling.annotation.EnableScheduling;

@SpringBootApplication
@EnableScheduling  // å¯ç”¨å®šæ—¶ä»»åŠ¡
public class EnglishAndWordApplication {
    public static void main(String[] args) {
        SpringApplication.run(EnglishAndWordApplication.class, args);
    }
}
```

## ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

### åç«¯å¼€å‘ä»»åŠ¡

#### æ•°æ®åº“å±‚
- [ ] åˆ›å»º `word_study_record` è¡¨
- [ ] åˆ›å»ºæ¯æ—¥å­¦ä¹ æ¸…å•ç”Ÿæˆå­˜å‚¨è¿‡ç¨‹
- [ ] åˆ›å»ºå®šæ—¶ä»»åŠ¡è§¦å‘å™¨
- [ ] æµ‹è¯•æ•°æ®åº“æ“ä½œ

#### å®ä½“å’ŒDTOå±‚
- [ ] åˆ›å»º `WordStudyRecord.java` å®ä½“ç±»
- [ ] åˆ›å»º `StudySessionRequest.java` è¯·æ±‚DTO
- [ ] åˆ›å»º `StudyEndRequest.java` è¯·æ±‚DTO
- [ ] åˆ›å»º `ReviewCompleteRequest.java` è¯·æ±‚DTO
- [ ] åˆ›å»º `StudyLockStatusResponse.java` å“åº”DTO

#### Mapperå±‚
- [ ] åˆ›å»º `WordStudyMapper.java` æ¥å£
- [ ] å®ç°å­¦ä¹ è®°å½•CRUDæ“ä½œ
- [ ] å®ç°å¤ä¹ çŠ¶æ€æŸ¥è¯¢æ–¹æ³•
- [ ] å®ç°é”å®šçŠ¶æ€æ£€æŸ¥æ–¹æ³•
- [ ] ç¼–å†™å¯¹åº”çš„XMLæ˜ å°„æ–‡ä»¶

#### Serviceå±‚
- [ ] åˆ›å»º `WordStudyService.java` æ¥å£
- [ ] åˆ›å»º `StudyLockService.java` æ¥å£
- [ ] å®ç° `WordStudyServiceImpl.java`
- [ ] å®ç° `StudyLockServiceImpl.java`
- [ ] å®ç°ä¸šåŠ¡é€»è¾‘å’Œäº‹åŠ¡ç®¡ç†

#### Controllerå±‚
- [ ] åˆ›å»º `WordStudyController.java`
- [ ] åˆ›å»º `StudyLockController.java`
- [ ] å®ç°æ‰€æœ‰APIç«¯ç‚¹
- [ ] æ·»åŠ å‚æ•°éªŒè¯å’Œå¼‚å¸¸å¤„ç†

#### å®šæ—¶ä»»åŠ¡
- [ ] åˆ›å»º `StudyTaskScheduler.java`
- [ ] å®ç°æ¯æ—¥å­¦ä¹ æ¸…å•ç”Ÿæˆä»»åŠ¡
- [ ] å®ç°è¶…æ—¶ä¼šè¯å¤„ç†ä»»åŠ¡
- [ ] é…ç½®å®šæ—¶ä»»åŠ¡æ‰§è¡Œ

### å‰ç«¯å¼€å‘ä»»åŠ¡

#### ç»„ä»¶å¼€å‘
- [ ] åˆ›å»º `StudyTimer.vue` å­¦ä¹ è®¡æ—¶å™¨ç»„ä»¶
- [ ] åˆ›å»º `RangeSelector.vue` èŒƒå›´é€‰æ‹©ç»„ä»¶
- [ ] åˆ›å»º `StudyLockGuard.vue` é”å®šæ£€æŸ¥ç»„ä»¶
- [ ] åˆ›å»º `ReviewProgress.vue` å¤ä¹ è¿›åº¦ç»„ä»¶

#### çŠ¶æ€ç®¡ç†
- [ ] åˆ›å»º `wordStudy.js` Store
- [ ] å®ç°å­¦ä¹ ä¼šè¯çŠ¶æ€ç®¡ç†
- [ ] å®ç°é”å®šçŠ¶æ€ç®¡ç†
- [ ] é›†æˆç°æœ‰çš„ `word.js` Store

#### æœåŠ¡å±‚
- [ ] åˆ›å»º `wordStudy.service.js`
- [ ] å®ç°æ‰€æœ‰APIè°ƒç”¨æ–¹æ³•
- [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- [ ] é›†æˆç°æœ‰çš„APIæœåŠ¡

#### é¡µé¢æ”¹é€ 
- [ ] æ”¹é€  `WordLearning.vue` é¡µé¢
- [ ] æ”¹é€  `WordReview.vue` é¡µé¢
- [ ] æ”¹é€  `WordReviewSelection.vue` é¡µé¢
- [ ] æ›´æ–°è·¯ç”±é…ç½®å’Œå®ˆå«

#### å…¨å±€åŠŸèƒ½
- [ ] é›†æˆå…¨å±€é”å®šæ£€æŸ¥
- [ ] æ·»åŠ è·¯ç”±å®ˆå«é€»è¾‘
- [ ] å®ç°å…¨å±€æç¤ºç»„ä»¶
- [ ] æ·»åŠ é”™è¯¯è¾¹ç•Œå¤„ç†

### ç³»ç»Ÿé›†æˆä»»åŠ¡

#### æ¥å£è”è°ƒ
- [ ] æµ‹è¯•å­¦ä¹ ä¼šè¯ç®¡ç†API
- [ ] æµ‹è¯•å¤ä¹ çŠ¶æ€æ£€æŸ¥API
- [ ] æµ‹è¯•é”å®šçŠ¶æ€API
- [ ] æµ‹è¯•å®šæ—¶ä»»åŠ¡æ‰§è¡Œ

#### åŠŸèƒ½æµ‹è¯•
- [ ] æµ‹è¯•30åˆ†é’Ÿå­¦ä¹ æµç¨‹
- [ ] æµ‹è¯•å¤ä¹ å®Œæˆæ ‡è®°
- [ ] æµ‹è¯•åŠŸèƒ½é”å®šæœºåˆ¶
- [ ] æµ‹è¯•å­¦ä¹ æ¸…å•ç”Ÿæˆ

#### æ€§èƒ½æµ‹è¯•
- [ ] æµ‹è¯•å¹¶å‘å­¦ä¹ ä¼šè¯
- [ ] æµ‹è¯•å¤§é‡æ•°æ®æŸ¥è¯¢
- [ ] æµ‹è¯•å®šæ—¶ä»»åŠ¡æ€§èƒ½
- [ ] ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢

#### ç”¨æˆ·ä½“éªŒæµ‹è¯•
- [ ] æµ‹è¯•ç§»åŠ¨ç«¯å“åº”å¼
- [ ] æµ‹è¯•å­¦ä¹ æµç¨‹ç”¨æˆ·ä½“éªŒ
- [ ] æµ‹è¯•å¼‚å¸¸æƒ…å†µå¤„ç†
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ

## ğŸš€ éƒ¨ç½²é…ç½®

### å¼€å‘ç¯å¢ƒé…ç½®

**application-dev.yml**
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/english_for_kiro?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai
    username: root
    password: your_password
  
  # å®šæ—¶ä»»åŠ¡é…ç½®
  task:
    scheduling:
      pool:
        size: 5
      thread-name-prefix: study-task-

# å­¦ä¹ ç®—æ³•é…ç½®
study:
  algorithm:
    # é»˜è®¤å­¦ä¹ æ—¶é•¿ï¼ˆç§’ï¼‰
    default-duration: 1800
    # å¤ä¹ é—´éš”é…ç½®ï¼ˆå°æ—¶ï¼‰
    review-intervals:
      round1: 0.17  # 10åˆ†é’Ÿå
      round2: 1     # 1å°æ—¶å
      round3: 24    # 1å¤©å
      round4: 168   # 1å‘¨å
    # åŠŸèƒ½é”å®šé…ç½®
    lock:
      enabled: true
      allowed-actions: ["REVIEW", "JOTTINGS", "HOME"]
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®

**application-prod.yml**
```yaml
spring:
  datasource:
    url: jdbc:mysql://your-prod-host:3306/english_for_kiro
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

# ç”Ÿäº§ç¯å¢ƒæ—¥å¿—é…ç½®
logging:
  level:
    com.austain: INFO
    org.springframework.scheduling: INFO
  file:
    name: logs/english-study.log
```

## ğŸ“Š ç›‘æ§å’Œåˆ†æ

### å…³é”®æŒ‡æ ‡ç›‘æ§

1. **å­¦ä¹ ä¼šè¯æŒ‡æ ‡**
   - æ¯æ—¥å­¦ä¹ ä¼šè¯æ•°é‡
   - å¹³å‡å­¦ä¹ æ—¶é•¿
   - å­¦ä¹ å®Œæˆç‡
   - å¤ä¹ å®Œæˆç‡

2. **ç”¨æˆ·è¡Œä¸ºæŒ‡æ ‡**
   - åŠŸèƒ½é”å®šè§¦å‘æ¬¡æ•°
   - å¤ä¹ ä»»åŠ¡å®Œæˆæ—¶é—´
   - å­¦ä¹ èŒƒå›´é€‰æ‹©åˆ†å¸ƒ
   - å¼‚å¸¸é€€å‡ºç‡

3. **ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡**
   - APIå“åº”æ—¶é—´
   - æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
   - å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶é—´
   - å¹¶å‘ç”¨æˆ·æ•°

### æ•°æ®åˆ†æSQL

```sql
-- æ¯æ—¥å­¦ä¹ ç»Ÿè®¡
SELECT 
    DATE(create_time) as study_date,
    COUNT(*) as session_count,
    AVG(TIMESTAMPDIFF(SECOND, start_time, end_time)) as avg_duration,
    COUNT(CASE WHEN status = 0 THEN 1 END) as completed_sessions,
    COUNT(CASE WHEN round_1_review_time IS NOT NULL THEN 1 END) as round1_completed,
    COUNT(CASE WHEN round_2_review_time IS NOT NULL THEN 1 END) as round2_completed
FROM word_study_record 
WHERE create_time >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)
GROUP BY DATE(create_time)
ORDER BY study_date DESC;

-- ç”¨æˆ·å­¦ä¹ è¡Œä¸ºåˆ†æ
SELECT 
    user_id,
    COUNT(*) as total_sessions,
    AVG(end_id - start_id + 1) as avg_words_per_session,
    MAX(create_time) as last_study_time,
    COUNT(CASE WHEN round_1_review_time IS NULL AND status = 0 THEN 1 END) as pending_round1,
    COUNT(CASE WHEN round_2_review_time IS NULL AND round_1_review_time IS NOT NULL THEN 1 END) as pending_round2
FROM word_study_record 
WHERE create_time >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
GROUP BY user_id
ORDER BY total_sessions DESC;
```

---

## ï¿½ éœ€æ±‚å¯¹ç…§æ£€æŸ¥

### åŸå§‹éœ€æ±‚è¦†ç›–æƒ…å†µ

#### âœ… å·²å®Œå…¨è¦†ç›–çš„éœ€æ±‚

1. **30åˆ†é’Ÿæ–°è¯å­¦ä¹ é˜¶æ®µ**
   - âœ… 30åˆ†é’Ÿå€’è®¡æ—¶ç»„ä»¶ï¼ˆåœ†å½¢è¿›åº¦æ¡ï¼Œâ‰¥30dpå°ºå¯¸ï¼‰
   - âœ… é˜²è¯¯è§¦æœºåˆ¶ï¼ˆç¡®è®¤å¼¹çª—ï¼‰
   - âœ… å­¦ä¹ èŒƒå›´é€‰æ‹©ï¼ˆæ”¯æŒå¿«æ·æŒ‰é’®ã€ä¸‹åä¸ªã€‘ï¼‰
   - âœ… èµ·å§‹ä½ç½®start_idå’Œå¼€å§‹æ—¶é—´start_timeè®°å½•
   - âœ… å€’è®¡æ—¶ç»“æŸæç¤ºå’Œã€æ ‡è®°å¹¶ç»“æŸæœ¬è½®å­¦ä¹ ã€‘æŒ‰é’®
   - âœ… å¼ºåˆ¶æ€§ç»“æŸæŒ‰é’®ï¼ˆç”¨æˆ·å¿…é¡»ç‚¹å‡»æ‰èƒ½é€€å‡ºï¼‰
   - âœ… ç»“æŸä½ç½®end_idå’Œç»“æŸæ—¶é—´end_timeè®°å½•
   - âœ… word_study_recordè¡¨æ•°æ®æ’å…¥
   - âœ… é¼“åŠ±æ€§è¯­è¨€å’Œå¤ä¹ æç¤º

2. **çŠ¶æ€é”å®šä¸åŠŸèƒ½ç¦ç”¨æœºåˆ¶**
   - âœ… è§¦å‘æ¡ä»¶æ£€æŸ¥ï¼ˆround_1_review_time IS NULL OR round_2_review_time IS NULLï¼‰
   - âœ… å…¨å±€è­¦å‘Šå¼¹çª—
   - âœ… ä¸»åŠŸèƒ½ç¦ç”¨ï¼ˆæ–°è¯å­¦ä¹ ã€å¥å­ç»ƒä¹ ã€è®¾ç½®ç­‰ï¼‰
   - âœ… ä»…å…è®¸å¤ä¹ ä¸­å¿ƒå’Œç§¯ç´¯æœ¬åŠŸèƒ½

3. **å¤ä¹ å®Œæˆæ ‡è®°æœºåˆ¶**
   - âœ… ç¬¬ä¸€è½®å’Œç¬¬äºŒè½®å¤ä¹ é¡µé¢çš„ã€æ ‡è®°æœ¬è½®å¤ä¹ å·²å®Œæˆã€‘æŒ‰é’®
   - âœ… round_1_review_timeå’Œround_2_review_timeå­—æ®µæ›´æ–°
   - âœ… ä¸¤è½®å¤ä¹ å®Œæˆåå…¨å±€åŠŸèƒ½è§£é”

4. **æ•°æ®åº“è®¾è®¡**
   - âœ… word_study_recordè¡¨ç»“æ„å®Œå…¨åŒ¹é…éœ€æ±‚
   - âœ… æ‰€æœ‰å¿…éœ€å­—æ®µå’Œç´¢å¼•
   - âœ… 8è½®å¤ä¹ å­—æ®µé¢„ç•™

5. **æ¯æ—¥å­¦ä¹ æ¸…å•è‡ªåŠ¨ç”Ÿæˆ**
   - âœ… æ¯æ—¥å‡Œæ™¨2:00å®šæ—¶ä»»åŠ¡
   - âœ… å‰ä¸€å¤©å­¦ä¹ æ•°æ®æŸ¥è¯¢å’Œæ±‡æ€»
   - âœ… learning_checklistè¡¨æ’å…¥é€»è¾‘
   - âœ… æ¸…å•ç±»å‹æ ‡è®°ä¸º1ï¼ˆå•è¯ï¼‰

6. **éåŠŸèƒ½æ€§è¦æ±‚**
   - âœ… é¡µé¢åŠ è½½æ—¶çŠ¶æ€æ ¡éªŒ
   - âœ… æ•°æ®åº“äº‹åŠ¡ä¿è¯ä¸€è‡´æ€§
   - âœ… å€’è®¡æ—¶è§†è§‰åé¦ˆå’Œéœ‡åŠ¨æé†’
   - âœ… é”å®šçŠ¶æ€æ˜ç¡®å¼•å¯¼
   - âœ… å¤ä¹ è½®æ¬¡é…ç½®åŒ–æ”¯æŒ

#### âš ï¸ æ˜ç¡®ä¸å®ç°çš„éœ€æ±‚
- âŒ éš”æ—¥æœªå®Œæˆå¤ä¹ çš„å¼ºåˆ¶å¤„ç†ï¼ˆéœ€æ±‚æ–‡æ¡£æ˜ç¡®æ ‡æ³¨"æš‚æ—¶ä¸å®ç°"ï¼‰
- âŒ ç¬¬ä¸‰è½®åŠä»¥ä¸Šå¤ä¹ åŠŸèƒ½ï¼ˆå½“å‰åªå®ç°å‰ä¸¤è½®ï¼‰

### é¢å¤–å¢å¼ºåŠŸèƒ½

#### ğŸš€ è¶…å‡ºåŸå§‹éœ€æ±‚çš„å¢å¼º
1. **å­¦ä¹ ä½“éªŒä¼˜åŒ–**
   - å­¦ä¹ è¿›åº¦å¯è§†åŒ–
   - å“åº”å¼è®¾è®¡é€‚é…ç§»åŠ¨ç«¯
   - ç°ä»£åŒ–UIç»„ä»¶è®¾è®¡
   - é”®ç›˜å¿«æ·é”®æ”¯æŒ

2. **ç³»ç»Ÿå¥å£®æ€§**
   - å¼‚å¸¸æƒ…å†µå¤„ç†
   - ç½‘ç»œé”™è¯¯é‡è¯•æœºåˆ¶
   - æ•°æ®å¤‡ä»½å’Œæ¢å¤
   - æ€§èƒ½ç›‘æ§å’Œåˆ†æ

3. **å¼€å‘æ•ˆç‡**
   - å®Œæ•´çš„APIæ–‡æ¡£
   - ç»„ä»¶åŒ–è®¾è®¡
   - çŠ¶æ€ç®¡ç†ä¼˜åŒ–
   - è‡ªåŠ¨åŒ–æµ‹è¯•æ”¯æŒ

## ğŸ“ å®æ–½æ€»ç»“

æœ¬å®ç°æ–¹æ¡ˆå®Œæ•´è¦†ç›–äº†è‹±è¯­ç³»ç»Ÿå•è¯å­¦ä¹ ç®—æ³•çš„æ‰€æœ‰æ ¸å¿ƒéœ€æ±‚ï¼š

### âœ… å·²æ¶µç›–çš„åŠŸèƒ½
1. **30åˆ†é’Ÿæ–°è¯å­¦ä¹ æœºåˆ¶** - å®Œæ•´çš„è®¡æ—¶å™¨ç»„ä»¶å’Œä¼šè¯ç®¡ç†
2. **ä¸¤è½®å¼ºåˆ¶å¤ä¹ æµç¨‹** - å¤ä¹ çŠ¶æ€è·Ÿè¸ªå’Œå®Œæˆæ ‡è®°
3. **çŠ¶æ€é”å®šæœºåˆ¶** - å…¨å±€åŠŸèƒ½é”å®šå’Œç”¨æˆ·å¼•å¯¼
4. **å­¦ä¹ è®°å½•ç®¡ç†** - å®Œæ•´çš„æ•°æ®æ¨¡å‹å’ŒAPIè®¾è®¡
5. **æ¯æ—¥å­¦ä¹ æ¸…å•ç”Ÿæˆ** - å®šæ—¶ä»»åŠ¡å’Œæ•°æ®ç»Ÿè®¡
6. **å“åº”å¼UIè®¾è®¡** - é€‚é…PCå’Œç§»åŠ¨ç«¯çš„ç°ä»£åŒ–ç•Œé¢

### ğŸ”§ æŠ€æœ¯ç‰¹ç‚¹
1. **å‰åç«¯åˆ†ç¦»æ¶æ„** - æ¸…æ™°çš„APIæ¥å£è®¾è®¡
2. **çŠ¶æ€ç®¡ç†** - åŸºäºPiniaçš„å“åº”å¼çŠ¶æ€ç®¡ç†
3. **æ•°æ®æŒä¹…åŒ–** - MySQLæ•°æ®åº“å’ŒMyBatis ORM
4. **å®šæ—¶ä»»åŠ¡** - Spring Bootå®šæ—¶ä»»åŠ¡è°ƒåº¦
5. **ç”¨æˆ·ä½“éªŒ** - ç°ä»£åŒ–UIç»„ä»¶å’Œäº¤äº’è®¾è®¡

### ğŸ“ˆ æ‰©å±•æ€§è€ƒè™‘
1. **å…«è½®å¤ä¹ æ”¯æŒ** - æ•°æ®åº“é¢„ç•™8ä¸ªå¤ä¹ å­—æ®µ
2. **å¤šç§å¤ä¹ æ¨¡å¼** - å¯æ‰©å±•çš„å¤ä¹ ç±»å‹é…ç½®
3. **ä¸ªæ€§åŒ–é…ç½®** - å¯é…ç½®çš„å­¦ä¹ æ—¶é•¿å’Œå¤ä¹ é—´éš”
4. **æ•°æ®åˆ†æ** - å®Œæ•´çš„å­¦ä¹ æ•°æ®æ”¶é›†å’Œåˆ†æ

é€šè¿‡åˆ†é˜¶æ®µå®æ–½ï¼Œç¡®ä¿æ¯ä¸ªåŠŸèƒ½æ¨¡å—éƒ½ç»è¿‡å……åˆ†æµ‹è¯•å’ŒéªŒè¯ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªå®Œæ•´ã€å¯é ã€ç”¨æˆ·å‹å¥½çš„è‹±è¯­å­¦ä¹ ç³»ç»Ÿã€‚